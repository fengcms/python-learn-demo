---
title: "[转]前端开发问题之字符串日期转日期对象在safari浏览器中出现Invalid Date"
date: 2016-09-28 15:38:43 +0800
lastmod: 2016-09-28 15:38:43 +0800
author: fungleo
preview: "问题描述：开发中需要写一个倒计时，但是时间周期是根据后端传过来的开始时间和结束时间进行计算的，后端传过来的字符串日期格式为:2012-11-1222:11:22,在前端中我们使用newDate()来将其转为date对象，一切进行顺利，在各个浏览器都没问题，但是safari中却出现了“InvalidDate”的异常信息，难缠的兼容性问题出现！解决：一开始以为是Date()构造函数的问题，立马采"
tags: ["safari", "new-Date", "兼容性问题"]
categories:
    - JavaScript
---

##问题描述：
开发中需要写一个倒计时，但是时间周期是根据后端传过来的开始时间和结束时间进行计算的，后端传过来的字符串日期格式为:` 2012-11-12 22:11:22`,在前端中我们使用 `new Date()`来将其转为`date`对象，一切进行顺利，在各个浏览器都没问题，但是`safari`中却出现了`“Invalid Date”`的异常信息，难缠的兼容性问题出现！
##解决：
一开始以为是`Date()`构造函数的问题，立马采用静态方法，`Date.parse()`--未解决

然后想到了是字符串日期的格式问题，查阅相关es6标准文档，其中指出字符串日期格式必须符合ISO 8601标准，标准为：YYYY-MM-DDTHH:mm:ss.sssZ，同时文档也指出了各个段位的含义，以及在缺失状况的处理，那么问题来了，明显字符串日期的格式不符合这个标准，但是为什么其他浏览器却可以正确显示，个人猜测：其他浏览器厂商对这种字符串转日期在标准的基础上做了这种格式的扩展，然后safari并没有，其实我们无需具体了解各个浏览器厂商到底对这个格式做了什么扩展，我们统统都转为标准的格式，这样就能很好的解决各个浏览器的问题了
****
1.如果只是小面积的使用 可以使用正则进行替换：
```js
dateStr.replace(/\s/g,'T').replace(/\//g,'-');
```
2.如果大面积的使用，建议使用datejs进行处理，或者认为可以的其他第三方库

> 转载后记：最近基于VUE开发了一款日历插件（主要是自用），但是测试组在`safari`浏览器上测试的时候发现了这个问题，然后看到了这篇文章，用文章中的正则解决了此问题。因此转载此文。

原文链接：http://blog.csdn.net/sinat_31257007/article/details/49208789