{"data":{"id":"78856163","title":"Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff088\uff09\u4f7f\u7528 sqlite3 \u6570\u636e\u5e93\u5b58\u50a8\u751f\u6210\u7684\u5bc6\u7801\uff0cprettytable \u7684\u4f7f\u7528","articleedittype":1,"description":"Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff088\uff09\u4f7f\u7528 sqlite3 \u6570\u636e\u5e93\u5b58\u50a8\u751f\u6210\u7684\u5bc6\u7801\uff0cprettytable \u7684\u4f7f\u7528\u5728\u524d\u9762\u6211\u7528 python \u811a\u672c\u5b9e\u73b0\u7684 cli \u7248\u672c\u7684\u5bc6\u7801\u751f\u6210\u4e0e\u7ba1\u7406\u5de5\u5177\u4e2d\uff0c\u6211\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u6765\u5b58\u50a8\u6211\u4eec\u7684\u751f\u6210\u7684\u5bc6\u7801\u3002\u8be6\u60c5\u89c1\uff1ahttp:\/\/blog.csdn.net\/fungleo\/article\/details\/78842597\u8fd9\u6837\u505a\u6211\u611f\u89c9\u8fd8\u662f\u6709\u4e00\u4e9b\u6b20\u59a5\u3002\u56e0\u4e3a\u8fd9\u6837\u67e5\u770b\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u4f7f\u7528\u7cfb\u7edf\u547d\u4ee4\uff0c\u6216","content":"<h1 id=\"python3-\u521d\u5b66\u5b9e\u8df5\u6848\u4f8b8\u4f7f\u7528-sqlite3-\u6570\u636e\u5e93\u5b58\u50a8\u751f\u6210\u7684\u5bc6\u7801prettytable-\u7684\u4f7f\u7528\">Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff088\uff09\u4f7f\u7528 sqlite3 \u6570\u636e\u5e93\u5b58\u50a8\u751f\u6210\u7684\u5bc6\u7801\uff0cprettytable \u7684\u4f7f\u7528<\/h1>\n\n<p>\u5728\u524d\u9762\u6211\u7528 <code>python<\/code> \u811a\u672c\u5b9e\u73b0\u7684 <code>cli<\/code> \u7248\u672c\u7684\u5bc6\u7801\u751f\u6210\u4e0e\u7ba1\u7406\u5de5\u5177\u4e2d\uff0c\u6211\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u6765\u5b58\u50a8\u6211\u4eec\u7684\u751f\u6210\u7684\u5bc6\u7801\u3002\u8be6\u60c5\u89c1\uff1a<a href=\"http:\/\/blog.csdn.net\/fungleo\/article\/details\/78842597\" target=\"_blank\">http:\/\/blog.csdn.net\/fungleo\/article\/details\/78842597<\/a><\/p>\n\n<p>\u8fd9\u6837\u505a\u6211\u611f\u89c9\u8fd8\u662f\u6709\u4e00\u4e9b\u6b20\u59a5\u3002\u56e0\u4e3a\u8fd9\u6837\u67e5\u770b\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u4f7f\u7528\u7cfb\u7edf\u547d\u4ee4\uff0c\u6216\u8005\u5176\u4ed6 GUI \u5de5\u5177\u8fdb\u884c\u67e5\u770b\u3002\u5982\u679c\u6211\u8981\u7528 <code>python<\/code> \u6765\u5904\u7406\u548c\u5206\u6790\u8fd9\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u65e0\u7591\u5de5\u4f5c\u91cf\u662f\u5de8\u5927\u7684\u3002<\/p>\n\n<p>\u56e0\u6b64\uff0c\u6211\u5e0c\u671b\u7528\u6570\u636e\u5e93\u6765\u5b58\u50a8\u6211\u4eec\u751f\u6210\u7684\u5bc6\u7801\uff0c\u7136\u540e\u7528 <code>sql<\/code> \u8bed\u53e5\u6765\u8fdb\u884c\u67e5\u8be2\uff0c\u987a\u4fbf\u5199\u4e00\u4e2a\u67e5\u8be2\u5de5\u5177\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4f7f\u7528\u4e86\u3002<\/p>\n\n<p>\u5728\u6570\u636e\u5e93\u7684\u9009\u578b\u4e0a\uff0c\u6211\u51b3\u5b9a\u4f7f\u7528\u5355\u6587\u4ef6\u6570\u636e\u5e93 <code>sqlite<\/code> \u3002\u56e0\u4e3a\u8fd9\u6837\u6211\u4eec\u4e0d\u9700\u8981\u5b89\u88c5\u4e00\u4e2a\u6570\u636e\u5e93\u670d\u52a1\uff0c\u5e76\u4e14\u53ef\u4ee5\u968f\u65f6\u590d\u5236\u8d70\u3002<\/p>\n\n<p>\u518d\u8bf4\uff0c\u5c31\u4e00\u4e2a\u8868\u5c31\u53ef\u4ee5\u641e\u5b9a\u7684\u4e8b\u60c5\uff0c\u641e\u4e2a\u5927\u578b\u6570\u636e\u5e93\u4e5f\u786e\u5b9e\u6709\u70b9\u8131\u88e4\u5b50\u653e\u5c41\u7684\u611f\u89c9\u3002<\/p>\n\n<blockquote>\n  <p>\u672c\u6587\u662f <code>cli<\/code> \u5bc6\u7801\u751f\u6210\u7ba1\u7406\u5de5\u5177\u7684\u884d\u751f\u6587\u7ae0\u3002 <\/p>\n<\/blockquote>\n\n\n\n<h2 id=\"\u5f00\u59cb\u5b9e\u6218\">\u5f00\u59cb\u5b9e\u6218<\/h2>\n\n<p>\u7531\u4e8e\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u5bc6\u7801\u751f\u6210\u5de5\u5177\u7684\u4e3b\u4f53\u903b\u8f91\u4ee3\u7801\uff0c\u8fd9\u8fb9\u53ea\u662f\u5c06\u539f\u6765\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u5b58\u50a8\u5bc6\u7801\u4fee\u6539\u4e3a\u6570\u636e\u5e93\u5b58\u50a8\uff0c\u6240\u4ee5\uff0c\u6211\u4e0d\u60f3\u5927\u5e45\u4fee\u6539\u539f\u6709\u7684\u6587\u4ef6\u3002\u56e0\u6b64\u6211\u65b0\u521b\u5efa\u4e86\u4e00\u4e2a <code>db.py<\/code> \u6587\u4ef6\uff0c\u6765\u4e13\u95e8\u5199\u76f8\u5e94\u7684\u4ee3\u7801\u3002<\/p>\n\n<p>\u5168\u90e8\u4ee3\u7801\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-comment\">#!\/usr\/bin\/env python3<\/span>\n<span class=\"hljs-comment\"># -*- coding: UTF-8 -*-<\/span>\n<span class=\"hljs-keyword\">import<\/span> sqlite3\n<span class=\"hljs-keyword\">import<\/span> re\n<span class=\"hljs-keyword\">import<\/span> sys\n<span class=\"hljs-keyword\">from<\/span> prettytable <span class=\"hljs-keyword\">import<\/span> PrettyTable\n\nDB_PATH = sys.path[<span class=\"hljs-number\">0<\/span>] + <span class=\"hljs-string\">'\/passwd.db'<\/span>\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">checkDB<\/span><span class=\"hljs-params\">(db)<\/span>:<\/span>\n    db.execute(<span class=\"hljs-string\">'''SELECT name FROM sqlite_master\n                WHERE type IN ('table','view') AND name NOT LIKE 'sqlite_%'\n                ORDER BY 1'''<\/span>)\n    o = db.fetchall()\n    <span class=\"hljs-keyword\">if<\/span> len(o) == <span class=\"hljs-number\">0<\/span> <span class=\"hljs-keyword\">or<\/span> <span class=\"hljs-keyword\">not<\/span> bool(re.search(<span class=\"hljs-string\">r'(\\'passwd\\',)'<\/span>,str(o))):\n        db.execute(<span class=\"hljs-string\">'''CREATE TABLE passwd (\n            id integer primary key autoincrement,\n            name varchar(255),\n            password varchar(255),\n            time timestamp default current_timestamp\n        )'''<\/span>)\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">insertDb<\/span><span class=\"hljs-params\">(name,passwd)<\/span>:<\/span>\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    checkDB(c)\n    c.execute(<span class=\"hljs-string\">\"INSERT INTO passwd (name,password) VALUES ('\"<\/span> + name + <span class=\"hljs-string\">\"', '\"<\/span> + passwd + <span class=\"hljs-string\">\"')\"<\/span>);\n    conn.commit()\n    conn.close()\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">selectDb<\/span><span class=\"hljs-params\">(pid,name)<\/span>:<\/span>\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    checkDB(c)\n\n    select = <span class=\"hljs-string\">\"SELECT * from passwd \"<\/span>\n    <span class=\"hljs-keyword\">if<\/span> name:\n        select += (<span class=\"hljs-string\">'where name LIKE \\'%'<\/span> + name + <span class=\"hljs-string\">'%\\''<\/span>)\n    <span class=\"hljs-keyword\">if<\/span> pid:\n        select += (<span class=\"hljs-string\">'where id = \\''<\/span> + str(pid) + <span class=\"hljs-string\">'\\''<\/span>)\n    select += <span class=\"hljs-string\">'ORDER BY id DESC'<\/span>\n\n    res = list(c.execute(select))\n    <span class=\"hljs-keyword\">if<\/span> len(res) == <span class=\"hljs-number\">0<\/span>:\n        print(<span class=\"hljs-string\">'Info: record is empty'<\/span>)\n    <span class=\"hljs-keyword\">else<\/span>:\n        x = PrettyTable([<span class=\"hljs-string\">'id'<\/span>,<span class=\"hljs-string\">'name'<\/span>,<span class=\"hljs-string\">'password'<\/span>,<span class=\"hljs-string\">'time'<\/span>])\n        x.align[<span class=\"hljs-string\">'name'<\/span>] = <span class=\"hljs-string\">'l'<\/span>\n        x.padding_width = <span class=\"hljs-number\">1<\/span>\n        <span class=\"hljs-keyword\">for<\/span> row <span class=\"hljs-keyword\">in<\/span> res:\n            x.add_row(list(row))\n        print(x)\n    conn.close()\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">deleteDb<\/span><span class=\"hljs-params\">(pid)<\/span>:<\/span>\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    checkDB(c)\n    c.execute(<span class=\"hljs-string\">'DELETE from passwd where id='<\/span> + str(pid) )\n    conn.commit()\n    o = conn.total_changes\n    <span class=\"hljs-keyword\">if<\/span> o == <span class=\"hljs-number\">0<\/span>:\n        print(<span class=\"hljs-string\">'Failure: the password was not found'<\/span>)\n    <span class=\"hljs-keyword\">if<\/span> o == <span class=\"hljs-number\">1<\/span>:\n        print(<span class=\"hljs-string\">'Success: ID '<\/span> + str(pid) + <span class=\"hljs-string\">' password has been deleted'<\/span>)\n    conn.close()<\/code><\/pre>\n\n\n\n<h2 id=\"\u4ee3\u7801\u89e3\u6790\">\u4ee3\u7801\u89e3\u6790<\/h2>\n\n<p><strong>\u786e\u5b9a\u6570\u636e\u5e93\u8def\u5f84<\/strong><\/p>\n\n<p>\u6211\u4eec\u7684\u811a\u672c\u5199\u597d\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7cfb\u7edf\u7684\u4efb\u4f55\u5730\u65b9\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\u3002\u56e0\u6b64\uff0c\u6570\u636e\u5e93\u8def\u5f84\u5fc5\u987b\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\uff0c\u5426\u5219\u5b58\u5728\u54ea\u91cc\u5c31\u4e0d\u592a\u6e05\u695a\u4e86\u3002<\/p>\n\n<p>\u6211\u5e0c\u671b\u6587\u4ef6\u5b58\u50a8\u5728\u548c <code>db.py<\/code> \u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\uff0c\u56e0\u6b64\uff0c\u6211\u9700\u8981\u5148\u83b7\u53d6\u5230 <code>db.py<\/code> \u8fd9\u4e2a\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u3002\u6211\u4eec\u4f7f\u7528 <code>sys<\/code> \u5e93\u7684\u57fa\u672c\u529f\u80fd\u6765\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-keyword\">import<\/span> sys\nDB_PATH = sys.path[<span class=\"hljs-number\">0<\/span>] + <span class=\"hljs-string\">'\/passwd.db'<\/span><\/code><\/pre>\n\n<p>\u5176\u4e2d <code>sys.path[0]<\/code> \u5c31\u662f\u83b7\u53d6\u6587\u4ef6\u5b58\u5728\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u540e\u9762\u52a0\u4e0a\u6570\u636e\u5e93\u6587\u4ef6\u540d\u3002\u7136\u540e\u5b58\u4e00\u4e2a\u5e38\u91cf\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u51fd\u6570\u4e2d\u4f7f\u7528\u6570\u636e\u5e93\u4f4d\u7f6e\u5e38\u91cf\u6765\u8c03\u7528\u6570\u636e\u5e93\u4e86\u3002<\/p>\n\n<p><strong>sqlite \u6570\u636e\u5e93\u7684\u8fde\u63a5<\/strong><\/p>\n\n<p>\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u5e93\uff0c\u7136\u540e\u521b\u5efa\u8fde\u63a5\uff0c\u8fde\u63a5\u6253\u5f00\u540e\uff0c\u6211\u4eec\u6267\u884c\u6211\u4eec\u5e0c\u671b\u64cd\u4f5c\u7684 <code>sql<\/code> \u8bed\u53e5\uff0c\u7136\u540e\u518d\u5173\u95ed\u8fde\u63a5\uff0c\u5c31\u5b8c\u6210\u4e86\u6211\u4eec\u5e0c\u671b\u7684\u5de5\u4f5c\u4e86\u3002<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-keyword\">import<\/span> sqlite3\n\nconn = sqlite3.connect(DB_PATH)\nc = conn.cursor()\nc.execute(<span class=\"hljs-string\">\"__\u8fd9\u91cc\u662f\u4e00\u6761SQL\u8bed\u53e5__\"<\/span>);\nconn.commit()\nconn.close()<\/code><\/pre>\n\n<p>\u5982\u4e0a\uff0c\u57fa\u672c\u5c31\u662f\u4e00\u6761 <code>sql<\/code> \u8bed\u53e5\u7684\u6267\u884c\u5168\u8fc7\u7a0b\u4e86\u3002\u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u8fde\u63a5\u5185\u64cd\u4f5c\u591a\u6761 <code>SQL<\/code> \u8bed\u53e5\uff0c\u4f46\u662f\u5c31\u6211\u4eec\u7684\u8fd9\u4e2a\u5de5\u5177\u6765\u8bf4\uff0c\u4e00\u822c\u90fd\u662f\u4e00\u6761\u4e00\u6761\u7684\u6267\u884c\uff0c\u9700\u8981\u6267\u884c\u7684\u65f6\u5019\u521b\u5efa\u8fde\u63a5\uff0c\u8fde\u63a5\u597d\u4e86\u4e4b\u540e\uff0c\u6211\u4eec\u6267\u884c\u4ee3\u7801\uff0c\u7136\u540e\u63d0\u4ea4\uff0c\u7136\u540e\u5173\u95ed\u3002<\/p>\n\n<blockquote>\n  <p>\u5982\u679c\u6570\u636e\u5e93\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u8fd9\u4e2a\u662f\u4e2a\u81ea\u52a8\u7684\u673a\u5236\uff0c\u6211\u4eec\u5c31\u4e0d\u7528\u7ba1\u4e86\u3002<\/p>\n<\/blockquote>\n\n<p><strong>\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u8868<\/strong><\/p>\n\n<p>\u4e00\u4e2a\u65b0\u521b\u5efa\u7684\u6570\u636e\u5e93\u5f53\u4e2d\u662f\u6ca1\u6709\u4efb\u4f55\u8868\u7684\u3002\u6211\u4eec\u4e0d\u80fd\u8981\u6c42\u6211\u4eec\u7684\u7528\u6237\u81ea\u5df1\u53bb\u641e\u597d\u4e00\u4e2a\u8868\u518d\u6765\u4f7f\u7528\u3002\u56e0\u6b64\uff0c\u5f53\u6570\u636e\u5e93\u4e0d\u5b58\u5728\uff0c\u5728\u7b2c\u4e00\u6b21\u94fe\u63a5\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521b\u5efa\u8fd9\u4e2a\u6570\u636e\u5e93\uff0c\u4f46\u662f\u8fd9\u4e2a\u6570\u636e\u5e93\u4e2d\u662f\u6ca1\u6709\u4efb\u4f55\u8868\u7684\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u6709\u6ca1\u6709\u8868\uff0c\u5982\u679c\u6709\u8868\uff0c\u90a3\u4e48\u6709\u6ca1\u6709\u6211\u4eec\u4f7f\u7528\u7684\u8fd9\u4e2a\u8868\uff0c\u5982\u679c\u4e0d\u7b26\u5408\u6761\u4ef6\uff0c\u6211\u4eec\u5219\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u5e76\u4e14\u8fd9\u4e2a\u8868\u7684\u7ed3\u6784\u8981\u7b26\u5408\u6211\u4eec\u7684\u8bbe\u8ba1\u3002<\/p>\n\n<p>\u6574\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-keyword\">import<\/span> re\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">checkDB<\/span><span class=\"hljs-params\">(db)<\/span>:<\/span>\n    db.execute(<span class=\"hljs-string\">'''SELECT name FROM sqlite_master\n                WHERE type IN ('table','view') AND name NOT LIKE 'sqlite_%'\n                ORDER BY 1'''<\/span>)\n    o = db.fetchall()\n    <span class=\"hljs-keyword\">if<\/span> len(o) == <span class=\"hljs-number\">0<\/span> <span class=\"hljs-keyword\">or<\/span> <span class=\"hljs-keyword\">not<\/span> bool(re.search(<span class=\"hljs-string\">r'(\\'passwd\\',)'<\/span>,str(o))):\n        db.execute(<span class=\"hljs-string\">'''CREATE TABLE passwd (\n            id integer primary key autoincrement,\n            name varchar(255),\n            password varchar(255),\n            time timestamp default current_timestamp\n        )'''<\/span>)<\/code><\/pre>\n\n<p>\u5982\u4e0a\uff0c\u6211\u4eec\u8fd9\u4e2a\u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u68c0\u67e5\u72b6\u51b5\uff0c\u5982\u679c\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u5c31\u76f4\u63a5\u521b\u5efa\u3002\u90a3\u4e48\uff0c\u5728\u6211\u4eec\u9700\u8981\u68c0\u67e5\u7684\u5730\u65b9\uff0c\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u5c31\u53ef\u4ee5\u68c0\u67e5\u4e86\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">insertDb<\/span><span class=\"hljs-params\">(name,passwd)<\/span>:<\/span>\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    <span class=\"hljs-comment\"># \u5c31\u662f\u8fd9\u91cc\uff0c\u6211\u5148\u68c0\u67e5\u4e86\u4e00\u4e0b\u3002<\/span>\n    checkDB(c)\n    c.execute(<span class=\"hljs-string\">\"INSERT INTO passwd (name,password) VALUES ('\"<\/span> + name + <span class=\"hljs-string\">\"', '\"<\/span> + passwd + <span class=\"hljs-string\">\"')\"<\/span>);\n    conn.commit()\n    conn.close()<\/code><\/pre>\n\n<blockquote>\n  <p>\u4e0a\u9762\u6211\u4f7f\u7528\u4e86\u6b63\u5219\u6765\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u662f\u5426\u5b58\u5728\u6211\u4eec\u9700\u8981\u7684 <code>passwd<\/code> \u8868\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5f15\u5165\u6b63\u5219\u5e93\u3002<\/p>\n<\/blockquote>\n\n<p><strong>\u4f18\u96c5\u7684\u5728\u7ec8\u7aef\u5185\u5c55\u793a\u8868\u683c<\/strong><\/p>\n\n<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>select<\/code> \u8bed\u53e5\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u51fa\u6765\u5185\u5bb9\uff0c\u7136\u540e\u4f7f\u7528 <code>list()<\/code> \u65b9\u6cd5\u5c31\u53ef\u4ee5\u8f6c\u6362\u6210\u53ef\u4ee5\u5faa\u73af\u7684\u5217\u8868\u3002\u4f46\u662f\u5982\u4f55\u4f18\u96c5\u7684\u5728\u7ec8\u7aef\u5185\u5c55\u793a\u8868\u683c\u5462\uff1f\u8fd9\u91cc\uff0c\u6211\u4f7f\u7528\u4e86\u4e00\u4e2a <code>python<\/code> \u7684\u5e93 <code>prettytable<\/code> \u6765\u89e3\u51b3\u6211\u7684\u95ee\u9898\u3002<\/p>\n\n<blockquote>\n  <p>\u4e0d\u4f7f\u7528 <code>list()<\/code> \u51fd\u6570\u4e5f\u53ef\u4ee5\u5faa\u73af\u7684\u3002<\/p>\n<\/blockquote>\n\n<p>\u6f14\u793a\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-keyword\">from<\/span> prettytable <span class=\"hljs-keyword\">import<\/span> PrettyTable\n\n<span class=\"hljs-comment\"># \u4ece\u6570\u636e\u5e93\u62ff\u5230\u7ed3\u679c\uff0c\u8f6c\u6362\u6210\u5217\u8868<\/span>\nres = list(c.execute(select))\n<span class=\"hljs-comment\"># \u7ed9\u8f93\u51fa\u7684\u8868\u683c\u8bbe\u5b9a\u8868\u5934\uff0c\u6709\u51e0\u5217\u5c31\u8bbe\u5b9a\u51e0\u4e2a<\/span>\nx = PrettyTable([<span class=\"hljs-string\">'id'<\/span>,<span class=\"hljs-string\">'name'<\/span>,<span class=\"hljs-string\">'password'<\/span>,<span class=\"hljs-string\">'time'<\/span>])\n<span class=\"hljs-comment\"># \u53ef\u4ee5\u7ed9\u6307\u5b9a\u5217\u8bbe\u5b9a\u6587\u5b57\u5bf9\u9f50\uff0c\u9ed8\u8ba4\u662f\u5c45\u4e2d\u5bf9\u9f50\uff0c\u4e0b\u9762\u662f\u6539\u6210\u4e86 left \u5de6\u5bf9\u9f50<\/span>\nx.align[<span class=\"hljs-string\">'name'<\/span>] = <span class=\"hljs-string\">'l'<\/span>\n<span class=\"hljs-comment\"># \u8bbe\u5b9a\u8868\u683c\u5185\u586b\u5145\u4e3a 1 \u4e2a\u7a7a\u683c\uff0c\u8ba9\u8868\u683c\u53ef\u8bfb\u6027\u66f4\u9ad8<\/span>\nx.padding_width = <span class=\"hljs-number\">1<\/span>\n<span class=\"hljs-comment\"># \u5faa\u73af\u6570\u636e<\/span>\n<span class=\"hljs-keyword\">for<\/span> row <span class=\"hljs-keyword\">in<\/span> res:\n    <span class=\"hljs-comment\"># \u63d2\u5165\u6bcf\u4e00\u884c\u7684\u6570\u636e<\/span>\n    x.add_row(list(row))\n<span class=\"hljs-comment\"># \u6253\u5370\u8868\u683c<\/span>\nprint(x)<\/code><\/pre>\n\n<p>\u597d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8f93\u51fa\u4f18\u96c5\u7684\u8868\u683c\u4e86\u3002\u5176\u7ed3\u679c\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-# hljs asciidoc\"><span class=\"hljs-code\">+----+<\/span>--------------<span class=\"hljs-code\">+------------+<\/span>---------------------+\n<span class=\"hljs-header\">| id | name         |  password  |         time        |\n+----+--------------+------------+---------------------+<\/span>\n| 4  | 123          |  zTAT8DCU  | 2017-12-20 08:31:35 |\n| 3  | sunmingyuan2 | TxmKZt:44s | 2017-12-20 05:11:36 |\n<span class=\"hljs-header\">| 2  | sunmingyuan  | \/t22664Q44 | 2017-12-20 05:11:22 |\n+----+--------------+------------+---------------------+<\/span><\/code><\/pre>\n\n<p>\u5176\u4ed6\u5185\u5bb9\u90fd\u662f\u57fa\u7840\u7684 <code>sql<\/code> \u8bed\u53e5\u7684\u5185\u5bb9\u3002\u66f4\u591a <code>sql<\/code> \u5185\u5bb9\u53ef\u4ee5\u8bbf\u95ee <a href=\"http:\/\/www.w3school.com.cn\/sql\/index.asp\" target=\"_blank\">http:\/\/www.w3school.com.cn\/sql\/index.asp<\/a> \u83b7\u53d6\u3002<\/p>\n\n\n\n<h2 id=\"\u8865\u5145\u67e5\u770b\u548c\u5220\u9664\u5bc6\u7801\u7684\u7ba1\u7406\u811a\u672c-seepwpy-\u4ee3\u7801\">\u8865\u5145\u67e5\u770b\u548c\u5220\u9664\u5bc6\u7801\u7684\u7ba1\u7406\u811a\u672c seepw.py \u4ee3\u7801<\/h2>\n\n<p>\u4e0a\u9762\u6211\u4eec\u7684 <code>db.py<\/code> \u811a\u672c\u4e2d\uff0c\u9664\u4e86\u751f\u6210\u5bc6\u7801\u7684\u811a\u672c\u4e2d\u6211\u4eec\u9700\u8981\u7684\u63d2\u5165\u8bed\u53e5\u5916\uff0c\u6211\u8fd8\u5199\u4e86\u67e5\u770b\u4ee5\u53ca\u5220\u9664\u8bed\u53e5\u7684\u51fd\u6570\u3002\u6211\u4f7f\u7528\u4e86\u53e6\u5916\u4e00\u4e2a\u811a\u672c <code>seepw.py<\/code> \u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u529f\u80fd\u3002\u5176\u4ee3\u7801\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-comment\">#!\/usr\/bin\/env python3<\/span>\n<span class=\"hljs-comment\"># -*- coding: UTF-8 -*-<\/span>\n<span class=\"hljs-keyword\">import<\/span> db\n<span class=\"hljs-keyword\">import<\/span> argparse\n\n<span class=\"hljs-keyword\">if<\/span> __name__ == <span class=\"hljs-string\">'__main__'<\/span>:\n    parser = argparse.ArgumentParser()\n    parser.description=<span class=\"hljs-string\">'This program is used to manage the password saved in the database'<\/span>\n    parser.add_argument(<span class=\"hljs-string\">\"-v\"<\/span>, <span class=\"hljs-string\">\"--version\"<\/span>,action=<span class=\"hljs-string\">'version'<\/span>, version=<span class=\"hljs-string\">'%(prog)s 1.0'<\/span>)\n    group = parser.add_mutually_exclusive_group()\n    group.add_argument(<span class=\"hljs-string\">\"-i\"<\/span>, <span class=\"hljs-string\">\"--id\"<\/span>, help=<span class=\"hljs-string\">\"The ID of the password you want to look at\"<\/span>)\n    group.add_argument(<span class=\"hljs-string\">\"-n\"<\/span>, <span class=\"hljs-string\">\"--name\"<\/span>, help=<span class=\"hljs-string\">\"The NAME of the password you want to look at\"<\/span>)\n    group.add_argument(<span class=\"hljs-string\">\"-d\"<\/span>, <span class=\"hljs-string\">\"--delete\"<\/span>, help=<span class=\"hljs-string\">'Delete mode, the parameter is ID'<\/span>)\n    args = parser.parse_args()\n    name = args.name <span class=\"hljs-keyword\">if<\/span> args.name <span class=\"hljs-keyword\">else<\/span> <span class=\"hljs-keyword\">False<\/span>\n    pId = args.id <span class=\"hljs-keyword\">if<\/span> args.id <span class=\"hljs-keyword\">else<\/span> <span class=\"hljs-keyword\">False<\/span>\n    dId = args.delete\n\n    <span class=\"hljs-keyword\">if<\/span> dId:\n        <span class=\"hljs-keyword\">if<\/span> dId.isdigit():\n            db.deleteDb(dId)\n        <span class=\"hljs-keyword\">else<\/span>:\n            print(<span class=\"hljs-string\">'Error: The parameters of the delete mode must be number'<\/span>)\n    <span class=\"hljs-keyword\">else<\/span>:\n        db.selectDb(pId,name)<\/code><\/pre>\n\n<p>\u8fd9\u4e2a\u811a\u672c\u6ca1\u4ec0\u4e48\u66f4\u591a\u7684\u89e3\u91ca\uff0c\u53ea\u662f\u53bb\u914d\u7f6e\u4e86 <code>argparse<\/code> \u5e93\u7684\u5404\u79cd\u53c2\u6570\u7136\u540e\u5224\u65ad\u7528\u6237\u662f\u60f3\u67e5\u770b\u8fd8\u662f\u5220\u9664\uff0c\u7136\u540e\u6267\u884c\u5bf9\u5e94\u7684\u65b9\u6cd5\u5373\u53ef\u3002<\/p>\n\n\n\n<h2 id=\"\u8865\u5145\u751f\u6210\u5bc6\u7801\u7684\u4fee\u6539\">\u8865\u5145\u751f\u6210\u5bc6\u7801\u7684\u4fee\u6539<\/h2>\n\n<p>\u9996\u5148\u662f\u53bb\u9664\u539f\u6709\u7684\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u5b58\u50a8\u7684\u6240\u6709\u4ee3\u7801\uff0c\u5f15\u7528\u6211\u4eec\u7684 <code>db.py<\/code> \u6587\u4ef6\uff0c\u7136\u540e\u5728\u9700\u8981\u63d2\u5165\u5bc6\u7801\u5230\u6570\u636e\u5e93\u7684\u5730\u65b9\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u5373\u53ef\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u4fdd\u5b58\u7684\u6570\u636e\u3002<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">db.insertDb(name,passwd)<\/code><\/pre>\n\n<p>\u63a5\u4e0b\u6765\u6211\u4f1a\u62bd\u65f6\u95f4\u5199\u4e00\u4e2a\u4e00\u952e\u5b89\u88c5\u811a\u672c\uff0c\u5230\u65f6\u5019\u653e\u5230 <code>github<\/code> \u4e0a\u9762\uff0c\u7ed9\u5927\u5bb6\u4f7f\u7528\u3002<\/p>\n\n<p>\u672c\u6587\u7531 FungLeo \u539f\u521b\uff0c\u5141\u8bb8\u8f6c\u8f7d\uff0c\u4f46\u8f6c\u8f7d\u5fc5\u987b\u4fdd\u7559\u9996\u53d1\u94fe\u63a5\u3002<\/p>","markdowncontent":"# Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff088\uff09\u4f7f\u7528 sqlite3 \u6570\u636e\u5e93\u5b58\u50a8\u751f\u6210\u7684\u5bc6\u7801\uff0cprettytable \u7684\u4f7f\u7528\n\n\u5728\u524d\u9762\u6211\u7528 `python` \u811a\u672c\u5b9e\u73b0\u7684 `cli` \u7248\u672c\u7684\u5bc6\u7801\u751f\u6210\u4e0e\u7ba1\u7406\u5de5\u5177\u4e2d\uff0c\u6211\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u6765\u5b58\u50a8\u6211\u4eec\u7684\u751f\u6210\u7684\u5bc6\u7801\u3002\u8be6\u60c5\u89c1\uff1ahttp:\/\/blog.csdn.net\/fungleo\/article\/details\/78842597\n\n\u8fd9\u6837\u505a\u6211\u611f\u89c9\u8fd8\u662f\u6709\u4e00\u4e9b\u6b20\u59a5\u3002\u56e0\u4e3a\u8fd9\u6837\u67e5\u770b\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u4f7f\u7528\u7cfb\u7edf\u547d\u4ee4\uff0c\u6216\u8005\u5176\u4ed6 GUI \u5de5\u5177\u8fdb\u884c\u67e5\u770b\u3002\u5982\u679c\u6211\u8981\u7528 `python` \u6765\u5904\u7406\u548c\u5206\u6790\u8fd9\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u65e0\u7591\u5de5\u4f5c\u91cf\u662f\u5de8\u5927\u7684\u3002\n\n\u56e0\u6b64\uff0c\u6211\u5e0c\u671b\u7528\u6570\u636e\u5e93\u6765\u5b58\u50a8\u6211\u4eec\u751f\u6210\u7684\u5bc6\u7801\uff0c\u7136\u540e\u7528 `sql` \u8bed\u53e5\u6765\u8fdb\u884c\u67e5\u8be2\uff0c\u987a\u4fbf\u5199\u4e00\u4e2a\u67e5\u8be2\u5de5\u5177\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4f7f\u7528\u4e86\u3002\n\n\u5728\u6570\u636e\u5e93\u7684\u9009\u578b\u4e0a\uff0c\u6211\u51b3\u5b9a\u4f7f\u7528\u5355\u6587\u4ef6\u6570\u636e\u5e93 `sqlite` \u3002\u56e0\u4e3a\u8fd9\u6837\u6211\u4eec\u4e0d\u9700\u8981\u5b89\u88c5\u4e00\u4e2a\u6570\u636e\u5e93\u670d\u52a1\uff0c\u5e76\u4e14\u53ef\u4ee5\u968f\u65f6\u590d\u5236\u8d70\u3002\n\n\u518d\u8bf4\uff0c\u5c31\u4e00\u4e2a\u8868\u5c31\u53ef\u4ee5\u641e\u5b9a\u7684\u4e8b\u60c5\uff0c\u641e\u4e2a\u5927\u578b\u6570\u636e\u5e93\u4e5f\u786e\u5b9e\u6709\u70b9\u8131\u88e4\u5b50\u653e\u5c41\u7684\u611f\u89c9\u3002\n\n> \u672c\u6587\u662f `cli` \u5bc6\u7801\u751f\u6210\u7ba1\u7406\u5de5\u5177\u7684\u884d\u751f\u6587\u7ae0\u3002 \n\n## \u5f00\u59cb\u5b9e\u6218\n\n\u7531\u4e8e\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u5bc6\u7801\u751f\u6210\u5de5\u5177\u7684\u4e3b\u4f53\u903b\u8f91\u4ee3\u7801\uff0c\u8fd9\u8fb9\u53ea\u662f\u5c06\u539f\u6765\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u5b58\u50a8\u5bc6\u7801\u4fee\u6539\u4e3a\u6570\u636e\u5e93\u5b58\u50a8\uff0c\u6240\u4ee5\uff0c\u6211\u4e0d\u60f3\u5927\u5e45\u4fee\u6539\u539f\u6709\u7684\u6587\u4ef6\u3002\u56e0\u6b64\u6211\u65b0\u521b\u5efa\u4e86\u4e00\u4e2a `db.py` \u6587\u4ef6\uff0c\u6765\u4e13\u95e8\u5199\u76f8\u5e94\u7684\u4ee3\u7801\u3002\n\n\u5168\u90e8\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```python\n#!\/usr\/bin\/env python3\n# -*- coding: UTF-8 -*-\nimport sqlite3\nimport re\nimport sys\nfrom prettytable import PrettyTable\n\nDB_PATH = sys.path[0] + '\/passwd.db'\n\ndef checkDB(db):\n    db.execute('''SELECT name FROM sqlite_master\n                WHERE type IN ('table','view') AND name NOT LIKE 'sqlite_%'\n                ORDER BY 1''')\n    o = db.fetchall()\n    if len(o) == 0 or not bool(re.search(r'(\\'passwd\\',)',str(o))):\n        db.execute('''CREATE TABLE passwd (\n            id integer primary key autoincrement,\n            name varchar(255),\n            password varchar(255),\n            time timestamp default current_timestamp\n        )''')\ndef insertDb(name,passwd):\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    checkDB(c)\n    c.execute(\"INSERT INTO passwd (name,password) VALUES ('\" + name + \"', '\" + passwd + \"')\");\n    conn.commit()\n    conn.close()\n\ndef selectDb(pid,name):\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    checkDB(c)\n\n    select = \"SELECT * from passwd \"\n    if name:\n        select += ('where name LIKE \\'%' + name + '%\\'')\n    if pid:\n        select += ('where id = \\'' + str(pid) + '\\'')\n    select += 'ORDER BY id DESC'\n\n    res = list(c.execute(select))\n    if len(res) == 0:\n        print('Info: record is empty')\n    else:\n        x = PrettyTable(['id','name','password','time'])\n        x.align['name'] = 'l'\n        x.padding_width = 1\n        for row in res:\n            x.add_row(list(row))\n        print(x)\n    conn.close()\n\ndef deleteDb(pid):\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    checkDB(c)\n    c.execute('DELETE from passwd where id=' + str(pid) )\n    conn.commit()\n    o = conn.total_changes\n    if o == 0:\n        print('Failure: the password was not found')\n    if o == 1:\n        print('Success: ID ' + str(pid) + ' password has been deleted')\n    conn.close()\n```\n\n\n## \u4ee3\u7801\u89e3\u6790\n\n**\u786e\u5b9a\u6570\u636e\u5e93\u8def\u5f84**\n\n\u6211\u4eec\u7684\u811a\u672c\u5199\u597d\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7cfb\u7edf\u7684\u4efb\u4f55\u5730\u65b9\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\u3002\u56e0\u6b64\uff0c\u6570\u636e\u5e93\u8def\u5f84\u5fc5\u987b\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\uff0c\u5426\u5219\u5b58\u5728\u54ea\u91cc\u5c31\u4e0d\u592a\u6e05\u695a\u4e86\u3002\n\n\u6211\u5e0c\u671b\u6587\u4ef6\u5b58\u50a8\u5728\u548c `db.py` \u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\uff0c\u56e0\u6b64\uff0c\u6211\u9700\u8981\u5148\u83b7\u53d6\u5230 `db.py` \u8fd9\u4e2a\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u3002\u6211\u4eec\u4f7f\u7528 `sys` \u5e93\u7684\u57fa\u672c\u529f\u80fd\u6765\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```python\nimport sys\nDB_PATH = sys.path[0] + '\/passwd.db'\n```\n\n\u5176\u4e2d `sys.path[0]` \u5c31\u662f\u83b7\u53d6\u6587\u4ef6\u5b58\u5728\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u540e\u9762\u52a0\u4e0a\u6570\u636e\u5e93\u6587\u4ef6\u540d\u3002\u7136\u540e\u5b58\u4e00\u4e2a\u5e38\u91cf\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u51fd\u6570\u4e2d\u4f7f\u7528\u6570\u636e\u5e93\u4f4d\u7f6e\u5e38\u91cf\u6765\u8c03\u7528\u6570\u636e\u5e93\u4e86\u3002\n\n**sqlite \u6570\u636e\u5e93\u7684\u8fde\u63a5**\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u5e93\uff0c\u7136\u540e\u521b\u5efa\u8fde\u63a5\uff0c\u8fde\u63a5\u6253\u5f00\u540e\uff0c\u6211\u4eec\u6267\u884c\u6211\u4eec\u5e0c\u671b\u64cd\u4f5c\u7684 `sql` \u8bed\u53e5\uff0c\u7136\u540e\u518d\u5173\u95ed\u8fde\u63a5\uff0c\u5c31\u5b8c\u6210\u4e86\u6211\u4eec\u5e0c\u671b\u7684\u5de5\u4f5c\u4e86\u3002\n\n```python\nimport sqlite3\n\nconn = sqlite3.connect(DB_PATH)\nc = conn.cursor()\nc.execute(\"__\u8fd9\u91cc\u662f\u4e00\u6761SQL\u8bed\u53e5__\");\nconn.commit()\nconn.close()\n```\n\n\u5982\u4e0a\uff0c\u57fa\u672c\u5c31\u662f\u4e00\u6761 `sql` \u8bed\u53e5\u7684\u6267\u884c\u5168\u8fc7\u7a0b\u4e86\u3002\u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u8fde\u63a5\u5185\u64cd\u4f5c\u591a\u6761 `SQL` \u8bed\u53e5\uff0c\u4f46\u662f\u5c31\u6211\u4eec\u7684\u8fd9\u4e2a\u5de5\u5177\u6765\u8bf4\uff0c\u4e00\u822c\u90fd\u662f\u4e00\u6761\u4e00\u6761\u7684\u6267\u884c\uff0c\u9700\u8981\u6267\u884c\u7684\u65f6\u5019\u521b\u5efa\u8fde\u63a5\uff0c\u8fde\u63a5\u597d\u4e86\u4e4b\u540e\uff0c\u6211\u4eec\u6267\u884c\u4ee3\u7801\uff0c\u7136\u540e\u63d0\u4ea4\uff0c\u7136\u540e\u5173\u95ed\u3002\n\n> \u5982\u679c\u6570\u636e\u5e93\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u8fd9\u4e2a\u662f\u4e2a\u81ea\u52a8\u7684\u673a\u5236\uff0c\u6211\u4eec\u5c31\u4e0d\u7528\u7ba1\u4e86\u3002\n\n**\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u8868**\n\n\u4e00\u4e2a\u65b0\u521b\u5efa\u7684\u6570\u636e\u5e93\u5f53\u4e2d\u662f\u6ca1\u6709\u4efb\u4f55\u8868\u7684\u3002\u6211\u4eec\u4e0d\u80fd\u8981\u6c42\u6211\u4eec\u7684\u7528\u6237\u81ea\u5df1\u53bb\u641e\u597d\u4e00\u4e2a\u8868\u518d\u6765\u4f7f\u7528\u3002\u56e0\u6b64\uff0c\u5f53\u6570\u636e\u5e93\u4e0d\u5b58\u5728\uff0c\u5728\u7b2c\u4e00\u6b21\u94fe\u63a5\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521b\u5efa\u8fd9\u4e2a\u6570\u636e\u5e93\uff0c\u4f46\u662f\u8fd9\u4e2a\u6570\u636e\u5e93\u4e2d\u662f\u6ca1\u6709\u4efb\u4f55\u8868\u7684\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u6709\u6ca1\u6709\u8868\uff0c\u5982\u679c\u6709\u8868\uff0c\u90a3\u4e48\u6709\u6ca1\u6709\u6211\u4eec\u4f7f\u7528\u7684\u8fd9\u4e2a\u8868\uff0c\u5982\u679c\u4e0d\u7b26\u5408\u6761\u4ef6\uff0c\u6211\u4eec\u5219\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u5e76\u4e14\u8fd9\u4e2a\u8868\u7684\u7ed3\u6784\u8981\u7b26\u5408\u6211\u4eec\u7684\u8bbe\u8ba1\u3002\n\n\u6574\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```python\nimport re\ndef checkDB(db):\n    db.execute('''SELECT name FROM sqlite_master\n                WHERE type IN ('table','view') AND name NOT LIKE 'sqlite_%'\n                ORDER BY 1''')\n    o = db.fetchall()\n    if len(o) == 0 or not bool(re.search(r'(\\'passwd\\',)',str(o))):\n        db.execute('''CREATE TABLE passwd (\n            id integer primary key autoincrement,\n            name varchar(255),\n            password varchar(255),\n            time timestamp default current_timestamp\n        )''')\n```\n\n\u5982\u4e0a\uff0c\u6211\u4eec\u8fd9\u4e2a\u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u68c0\u67e5\u72b6\u51b5\uff0c\u5982\u679c\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u5c31\u76f4\u63a5\u521b\u5efa\u3002\u90a3\u4e48\uff0c\u5728\u6211\u4eec\u9700\u8981\u68c0\u67e5\u7684\u5730\u65b9\uff0c\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u5c31\u53ef\u4ee5\u68c0\u67e5\u4e86\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a\n\n```python\ndef insertDb(name,passwd):\n    conn = sqlite3.connect(DB_PATH)\n    c = conn.cursor()\n    # \u5c31\u662f\u8fd9\u91cc\uff0c\u6211\u5148\u68c0\u67e5\u4e86\u4e00\u4e0b\u3002\n    checkDB(c)\n    c.execute(\"INSERT INTO passwd (name,password) VALUES ('\" + name + \"', '\" + passwd + \"')\");\n    conn.commit()\n    conn.close()\n```\n\n> \u4e0a\u9762\u6211\u4f7f\u7528\u4e86\u6b63\u5219\u6765\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u662f\u5426\u5b58\u5728\u6211\u4eec\u9700\u8981\u7684 `passwd` \u8868\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5f15\u5165\u6b63\u5219\u5e93\u3002\n\n**\u4f18\u96c5\u7684\u5728\u7ec8\u7aef\u5185\u5c55\u793a\u8868\u683c**\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `select` \u8bed\u53e5\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u51fa\u6765\u5185\u5bb9\uff0c\u7136\u540e\u4f7f\u7528 `list()` \u65b9\u6cd5\u5c31\u53ef\u4ee5\u8f6c\u6362\u6210\u53ef\u4ee5\u5faa\u73af\u7684\u5217\u8868\u3002\u4f46\u662f\u5982\u4f55\u4f18\u96c5\u7684\u5728\u7ec8\u7aef\u5185\u5c55\u793a\u8868\u683c\u5462\uff1f\u8fd9\u91cc\uff0c\u6211\u4f7f\u7528\u4e86\u4e00\u4e2a `python` \u7684\u5e93 `prettytable` \u6765\u89e3\u51b3\u6211\u7684\u95ee\u9898\u3002\n\n> \u4e0d\u4f7f\u7528 `list()` \u51fd\u6570\u4e5f\u53ef\u4ee5\u5faa\u73af\u7684\u3002\n\n\u6f14\u793a\u5982\u4e0b\uff1a\n\n```python\nfrom prettytable import PrettyTable\n\n# \u4ece\u6570\u636e\u5e93\u62ff\u5230\u7ed3\u679c\uff0c\u8f6c\u6362\u6210\u5217\u8868\nres = list(c.execute(select))\n# \u7ed9\u8f93\u51fa\u7684\u8868\u683c\u8bbe\u5b9a\u8868\u5934\uff0c\u6709\u51e0\u5217\u5c31\u8bbe\u5b9a\u51e0\u4e2a\nx = PrettyTable(['id','name','password','time'])\n# \u53ef\u4ee5\u7ed9\u6307\u5b9a\u5217\u8bbe\u5b9a\u6587\u5b57\u5bf9\u9f50\uff0c\u9ed8\u8ba4\u662f\u5c45\u4e2d\u5bf9\u9f50\uff0c\u4e0b\u9762\u662f\u6539\u6210\u4e86 left \u5de6\u5bf9\u9f50\nx.align['name'] = 'l'\n# \u8bbe\u5b9a\u8868\u683c\u5185\u586b\u5145\u4e3a 1 \u4e2a\u7a7a\u683c\uff0c\u8ba9\u8868\u683c\u53ef\u8bfb\u6027\u66f4\u9ad8\nx.padding_width = 1\n# \u5faa\u73af\u6570\u636e\nfor row in res:\n    # \u63d2\u5165\u6bcf\u4e00\u884c\u7684\u6570\u636e\n    x.add_row(list(row))\n# \u6253\u5370\u8868\u683c\nprint(x)\n```\n\n\u597d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8f93\u51fa\u4f18\u96c5\u7684\u8868\u683c\u4e86\u3002\u5176\u7ed3\u679c\u5982\u4e0b\uff1a\n\n```#\n+----+--------------+------------+---------------------+\n| id | name         |  password  |         time        |\n+----+--------------+------------+---------------------+\n| 4  | 123          |  zTAT8DCU  | 2017-12-20 08:31:35 |\n| 3  | sunmingyuan2 | TxmKZt:44s | 2017-12-20 05:11:36 |\n| 2  | sunmingyuan  | \/t22664Q44 | 2017-12-20 05:11:22 |\n+----+--------------+------------+---------------------+\n```\n\n\u5176\u4ed6\u5185\u5bb9\u90fd\u662f\u57fa\u7840\u7684 `sql` \u8bed\u53e5\u7684\u5185\u5bb9\u3002\u66f4\u591a `sql` \u5185\u5bb9\u53ef\u4ee5\u8bbf\u95ee http:\/\/www.w3school.com.cn\/sql\/index.asp \u83b7\u53d6\u3002\n\n## \u8865\u5145\u67e5\u770b\u548c\u5220\u9664\u5bc6\u7801\u7684\u7ba1\u7406\u811a\u672c seepw.py \u4ee3\u7801\n\n\u4e0a\u9762\u6211\u4eec\u7684 `db.py` \u811a\u672c\u4e2d\uff0c\u9664\u4e86\u751f\u6210\u5bc6\u7801\u7684\u811a\u672c\u4e2d\u6211\u4eec\u9700\u8981\u7684\u63d2\u5165\u8bed\u53e5\u5916\uff0c\u6211\u8fd8\u5199\u4e86\u67e5\u770b\u4ee5\u53ca\u5220\u9664\u8bed\u53e5\u7684\u51fd\u6570\u3002\u6211\u4f7f\u7528\u4e86\u53e6\u5916\u4e00\u4e2a\u811a\u672c `seepw.py` \u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u529f\u80fd\u3002\u5176\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```python\n#!\/usr\/bin\/env python3\n# -*- coding: UTF-8 -*-\nimport db\nimport argparse\n\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser()\n    parser.description='This program is used to manage the password saved in the database'\n    parser.add_argument(\"-v\", \"--version\",action='version', version='%(prog)s 1.0')\n    group = parser.add_mutually_exclusive_group()\n    group.add_argument(\"-i\", \"--id\", help=\"The ID of the password you want to look at\")\n    group.add_argument(\"-n\", \"--name\", help=\"The NAME of the password you want to look at\")\n    group.add_argument(\"-d\", \"--delete\", help='Delete mode, the parameter is ID')\n    args = parser.parse_args()\n    name = args.name if args.name else False\n    pId = args.id if args.id else False\n    dId = args.delete\n\n    if dId:\n        if dId.isdigit():\n            db.deleteDb(dId)\n        else:\n            print('Error: The parameters of the delete mode must be number')\n    else:\n        db.selectDb(pId,name)\n```\n\n\u8fd9\u4e2a\u811a\u672c\u6ca1\u4ec0\u4e48\u66f4\u591a\u7684\u89e3\u91ca\uff0c\u53ea\u662f\u53bb\u914d\u7f6e\u4e86 `argparse` \u5e93\u7684\u5404\u79cd\u53c2\u6570\u7136\u540e\u5224\u65ad\u7528\u6237\u662f\u60f3\u67e5\u770b\u8fd8\u662f\u5220\u9664\uff0c\u7136\u540e\u6267\u884c\u5bf9\u5e94\u7684\u65b9\u6cd5\u5373\u53ef\u3002\n\n## \u8865\u5145\u751f\u6210\u5bc6\u7801\u7684\u4fee\u6539\n\n\u9996\u5148\u662f\u53bb\u9664\u539f\u6709\u7684\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u5b58\u50a8\u7684\u6240\u6709\u4ee3\u7801\uff0c\u5f15\u7528\u6211\u4eec\u7684 `db.py` \u6587\u4ef6\uff0c\u7136\u540e\u5728\u9700\u8981\u63d2\u5165\u5bc6\u7801\u5230\u6570\u636e\u5e93\u7684\u5730\u65b9\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u5373\u53ef\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u4fdd\u5b58\u7684\u6570\u636e\u3002\n\n```python\ndb.insertDb(name,passwd)\n```\n\n\u63a5\u4e0b\u6765\u6211\u4f1a\u62bd\u65f6\u95f4\u5199\u4e00\u4e2a\u4e00\u952e\u5b89\u88c5\u811a\u672c\uff0c\u5230\u65f6\u5019\u653e\u5230 `github` \u4e0a\u9762\uff0c\u7ed9\u5927\u5bb6\u4f7f\u7528\u3002\n\n\u672c\u6587\u7531 FungLeo \u539f\u521b\uff0c\u5141\u8bb8\u8f6c\u8f7d\uff0c\u4f46\u8f6c\u8f7d\u5fc5\u987b\u4fdd\u7559\u9996\u53d1\u94fe\u63a5\u3002\n\n","private":0,"tags":"\u6570\u636e\u5e93,python,sqlite3,\u5bc6\u7801,\u5b58\u50a8","categories":"python3","channel":"16","type":"original","status":1},"error":"","status":true}