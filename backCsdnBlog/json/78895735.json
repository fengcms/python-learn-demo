{"data":{"id":"78895735","title":"Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff0812\uff09\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u6839\u636e\u8bbe\u5b9a\u6700\u957f\u8fb9\u53c2\u6570\u4fdd\u5b58\u5230\u76ee\u6807\u76ee\u5f55\u811a\u672c\uff08Image \u7684\u4f7f\u7528\uff09","articleedittype":1,"description":"Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff0812\uff09\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u6839\u636e\u8bbe\u5b9a\u6700\u957f\u8fb9\u53c2\u6570\u4fdd\u5b58\u5230\u76ee\u6807\u76ee\u5f55\u811a\u672c\uff08Image \u7684\u4f7f\u7528\uff09\u5982\u679c\u6211\u4eec\u7ed9\u5ba2\u6237\u5236\u4f5c\u7f51\u7ad9\uff0c\u5ba2\u6237\u4f1a\u53d1\u9001\u8fc7\u6765\u4e00\u5806\u7684\u56fe\u7247\uff0c\u8fd9\u4e9b\u56fe\u7247\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u624b\u673a\u6216\u8005\u6570\u7801\u76f8\u673a\u62cd\u6444\u7684\u3002\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u8fd9\u4e9b\u56fe\u7247\u4f1a\u6bd4\u8f83\u5927\u3002\u90a3\u6211\u4eec\u5c31\u9700\u8981\u5bf9\u8fd9\u4e9b\u56fe\u7247\u8fdb\u884c\u538b\u7f29\u7684\u5904\u7406\uff0c\u8fd9\u5c31\u662f\u6211\u5199\u7684\u8fd9\u4e2a\u811a\u672c\u7684\u5b9e\u9645\u7528\u9014\u3002\u5173\u952e\u95ee\u9898\u662f\u7b97\u6cd5\uff0c\u4f8b\u5982\uff0c\u6211\u8981\u6c42\u56fe\u7247\u6700\u957f\u8fb9\u4e3a 400px\uff0c\u90a3\u4e48\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u5904\u7406\u7684\u72b6\u6001\u5e94\u8be5\u662f\uff1a\n\u6e90\u56fe\u7247","content":"<h1 id=\"python3-\u521d\u5b66\u5b9e\u8df5\u6848\u4f8b12\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u6839\u636e\u8bbe\u5b9a\u6700\u957f\u8fb9\u53c2\u6570\u4fdd\u5b58\u5230\u76ee\u6807\u76ee\u5f55\u811a\u672cimage-\u7684\u4f7f\u7528\">Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff0812\uff09\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u6839\u636e\u8bbe\u5b9a\u6700\u957f\u8fb9\u53c2\u6570\u4fdd\u5b58\u5230\u76ee\u6807\u76ee\u5f55\u811a\u672c\uff08Image \u7684\u4f7f\u7528\uff09<\/h1>\n\n<p>\u5982\u679c\u6211\u4eec\u7ed9\u5ba2\u6237\u5236\u4f5c\u7f51\u7ad9\uff0c\u5ba2\u6237\u4f1a\u53d1\u9001\u8fc7\u6765\u4e00\u5806\u7684\u56fe\u7247\uff0c\u8fd9\u4e9b\u56fe\u7247\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u624b\u673a\u6216\u8005\u6570\u7801\u76f8\u673a\u62cd\u6444\u7684\u3002\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u8fd9\u4e9b\u56fe\u7247\u4f1a\u6bd4\u8f83\u5927\u3002\u90a3\u6211\u4eec\u5c31\u9700\u8981\u5bf9\u8fd9\u4e9b\u56fe\u7247\u8fdb\u884c\u538b\u7f29\u7684\u5904\u7406\uff0c\u8fd9\u5c31\u662f\u6211\u5199\u7684\u8fd9\u4e2a\u811a\u672c\u7684\u5b9e\u9645\u7528\u9014\u3002<\/p>\n\n<p>\u5173\u952e\u95ee\u9898\u662f\u7b97\u6cd5\uff0c\u4f8b\u5982\uff0c\u6211\u8981\u6c42\u56fe\u7247\u6700\u957f\u8fb9\u4e3a <code>400px<\/code>\uff0c\u90a3\u4e48\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u5904\u7406\u7684\u72b6\u6001\u5e94\u8be5\u662f\uff1a<\/p>\n\n<ol>\n<li>\u6e90\u56fe\u7247\u5c3a\u5bf8\u4e3a <code>800*600<\/code>\uff0c\u5219\u7f29\u653e\u540e\u7ed3\u679c\u662f <code>400*300<\/code><\/li>\n<li>\u6e90\u56fe\u7247\u5c3a\u5bf8\u4e3a <code>600*800<\/code>\uff0c\u5219\u7f29\u653e\u540e\u7ed3\u679c\u662f <code>300*400<\/code><\/li>\n<li>\u6e90\u56fe\u7247\u5c3a\u5bf8\u4e3a <code>300*200<\/code>\uff0c\u56e0\u4e3a\u65e0\u8bba\u662f\u5bbd\u548c\u9ad8\u5747\u5c0f\u4e8e\u6211\u4eec\u8bbe\u5b9a\u7684\u6700\u957f\u8fb9\uff0c\u6240\u4ee5\uff0c\u539f\u6837\u4fdd\u5b58\u4e0d\u505a\u5904\u7406\u3002<\/li>\n<\/ol>\n\n<p>\u597d\uff0c\u5982\u679c\u6211\u6587\u5b57\u63cf\u8ff0\u4e0d\u8db3\u4ee5\u8ba9\u4f60\u7406\u89e3\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u8be6\u7ec6\u4e3e\u4f8b\uff0c\u6211\u76f8\u4fe1\u5e94\u8be5\u80fd\u7406\u89e3\u6211\u7684\u610f\u56fe\u4e86\u3002<\/p>\n\n\n\n<h2 id=\"\u6700\u7ec8\u5b9e\u73b0\u6e90\u7801\">\u6700\u7ec8\u5b9e\u73b0\u6e90\u7801<\/h2>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-comment\">#!\/usr\/bin\/env python3<\/span>\n<span class=\"hljs-comment\"># -*- coding: UTF-8 -*-<\/span>\n<span class=\"hljs-keyword\">import<\/span> argparse\n<span class=\"hljs-keyword\">import<\/span> os\n<span class=\"hljs-keyword\">import<\/span> imghdr\n<span class=\"hljs-keyword\">from<\/span> PIL <span class=\"hljs-keyword\">import<\/span> Image\n\n<span class=\"hljs-comment\"># \u9519\u8bef\u9000\u51fa\u51fd\u6570<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">errMsn<\/span><span class=\"hljs-params\">(msn)<\/span>:<\/span>\n    print(<span class=\"hljs-string\">'\\033[31mError:\\033[0m '<\/span> + msn)\n    parser.print_usage()\n    exit()\n\n<span class=\"hljs-comment\"># \u5728\u6e90\u76ee\u5f55\u4e2d\u627e\u5230\u6240\u6709\u56fe\u7247\u5e76\u8f93\u51fa\u4e3a\u6570\u7ec4<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">findImg<\/span><span class=\"hljs-params\">(sdir)<\/span>:<\/span>\n    res = []\n    <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> os.path.exists(sDir):\n        errMsn(<span class=\"hljs-string\">'Source directory don\\'t exist'<\/span>)\n    <span class=\"hljs-keyword\">for<\/span> f <span class=\"hljs-keyword\">in<\/span> os.listdir(sdir):\n        fp = os.path.join(sdir, f)\n        <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> os.path.isdir(fp):\n            <span class=\"hljs-keyword\">if<\/span> imghdr.what(fp):\n                res.append(fp)\n    <span class=\"hljs-keyword\">if<\/span> len(res) == <span class=\"hljs-number\">0<\/span>:\n        errMsn(<span class=\"hljs-string\">'There is no image in the source directory'<\/span>)\n    <span class=\"hljs-keyword\">else<\/span>:\n        <span class=\"hljs-keyword\">return<\/span> res\n\n<span class=\"hljs-comment\"># \u5faa\u73af\u7f29\u653e\u6240\u6709\u56fe\u7247<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">resizeImg<\/span><span class=\"hljs-params\">(arr, size, tdir, imgQual)<\/span>:<\/span>\n    <span class=\"hljs-keyword\">for<\/span> img <span class=\"hljs-keyword\">in<\/span> arr:\n        simg = Image.open(img)\n        simg_w = simg.size[<span class=\"hljs-number\">0<\/span>]\n        simg_h = simg.size[<span class=\"hljs-number\">1<\/span>]\n\n        <span class=\"hljs-comment\"># \u5982\u679c\u539f\u56fe\u7247\u5bbd\u9ad8\u5747\u5c0f\u4e8e\u8bbe\u7f6e\u5c3a\u5bf8\uff0c\u5219\u5c06\u539f\u56fe\u76f4\u63a5\u590d\u5236\u5230\u76ee\u6807\u76ee\u5f55\u4e2d<\/span>\n        <span class=\"hljs-keyword\">if<\/span> simg_w &lt;= size <span class=\"hljs-keyword\">and<\/span> simg_h &lt;= size:\n            simg.save(tdir + <span class=\"hljs-string\">'\/'<\/span> + os.path.basename(img), quality=imgQual)\n        <span class=\"hljs-keyword\">else<\/span>:\n            <span class=\"hljs-comment\"># \u6bd4\u8f83\u6e90\u56fe\u7247\u7684\u5bbd\u9ad8\uff0c\u8ba1\u7b97\u5904\u7406\u540e\u7684\u5bbd\u9ad8<\/span>\n            timg_w = size\n            timg_h = int(size * simg_h \/ simg_w)\n            <span class=\"hljs-keyword\">if<\/span> simg_w &lt; simg_h:\n                timg_w = int(size * simg_w \/ simg_h)\n                timg_h = size\n            <span class=\"hljs-comment\"># \u7f29\u5c0f\u56fe\u7247\u5e76\u4fdd\u5b58<\/span>\n            timg = simg.resize((timg_w, timg_h),Image.ANTIALIAS)\n            timg.save(tdir + <span class=\"hljs-string\">'\/'<\/span> + os.path.basename(img), quality=imgQual)\n    print(<span class=\"hljs-string\">'\\033[32mSuccess:\\033[0m Task Finish'<\/span>)\n\n<span class=\"hljs-comment\"># \u76ee\u6807\u76ee\u5f55\u5904\u7406\u51fd\u6570<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">checkTargetDir<\/span><span class=\"hljs-params\">(sdir, tdir)<\/span>:<\/span>\n    <span class=\"hljs-comment\"># \u5982\u679c\u76ee\u6807\u76ee\u5f55\u4e3a\u7a7a\u65f6\u63d0\u793a\u7528\u6237\u786e\u8ba4<\/span>\n    <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> tdir:\n        print(<span class=\"hljs-string\">'\\033[33mWarning:\\033[0m If the target directory isn\\'t set, the processing '<\/span>\\\n                <span class=\"hljs-string\">'results will cover the picture in the source directory\\n'<\/span>\\\n                <span class=\"hljs-string\">'\\033[36mWhether to Continue(Y\/n)\\033[0m '<\/span>)\n        confirm = input(<span class=\"hljs-string\">'Confirm:'<\/span>)\n        <span class=\"hljs-keyword\">if<\/span> confirm <span class=\"hljs-keyword\">in<\/span> (<span class=\"hljs-string\">''<\/span>, <span class=\"hljs-string\">'Y'<\/span>, <span class=\"hljs-string\">'y'<\/span>):\n            print(<span class=\"hljs-string\">'\\033[34mInfo:\\033[0m The target directory is '<\/span> + sdir)\n            <span class=\"hljs-keyword\">return<\/span> sdir\n        <span class=\"hljs-keyword\">else<\/span>:\n            exit()\n    <span class=\"hljs-keyword\">else<\/span>:\n        <span class=\"hljs-comment\"># \u5982\u679c\u76ee\u6807\u76ee\u5f55\u8bbe\u5b9a\uff0c\u4f46\u662f\u4e0d\u5b58\u5728\uff0c\u5219\u63d0\u793a\u7528\u6237\u662f\u5426\u521b\u5efa\u76ee\u6807\u76ee\u5f55<\/span>\n        <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> os.path.exists(tdir):\n            print(<span class=\"hljs-string\">'Target directory don\\'t exist\\n'<\/span>\\\n                    <span class=\"hljs-string\">'\\033[36mWhether to create the Target directory(Y\/n)\\033[0m'<\/span>)\n            confirm = input(<span class=\"hljs-string\">'Confirm:'<\/span>)\n            <span class=\"hljs-keyword\">if<\/span> confirm <span class=\"hljs-keyword\">in<\/span> (<span class=\"hljs-string\">''<\/span>, <span class=\"hljs-string\">'Y'<\/span>, <span class=\"hljs-string\">'y'<\/span>):\n                os.makedirs(tdir)\n                <span class=\"hljs-keyword\">return<\/span> tdir\n            <span class=\"hljs-keyword\">else<\/span>:\n                exit()\n        <span class=\"hljs-keyword\">else<\/span>:\n            <span class=\"hljs-keyword\">return<\/span> tdir\n\n<span class=\"hljs-keyword\">if<\/span> __name__ == <span class=\"hljs-string\">\"__main__\"<\/span>:\n    <span class=\"hljs-comment\"># \u8bbe\u7f6e\u547d\u4ee4\u884c\u53c2\u6570<\/span>\n    parser = argparse.ArgumentParser()\n    parser.description=<span class=\"hljs-string\">'Reduce the picture in the source directory and save it to \\\n            the target directory based on the longest side parameters'<\/span>\n    parser.add_argument(<span class=\"hljs-string\">\"-v\"<\/span>, <span class=\"hljs-string\">\"--version\"<\/span>,action=<span class=\"hljs-string\">'version'<\/span>, version=<span class=\"hljs-string\">'%(prog)s 1.0'<\/span>)\n    parser.add_argument(<span class=\"hljs-string\">'size'<\/span>, type=int, help=<span class=\"hljs-string\">'The max width or max height of a picture'<\/span>)\n    parser.add_argument(<span class=\"hljs-string\">'sourceDir'<\/span>, help=<span class=\"hljs-string\">'Source directory'<\/span>)\n    parser.add_argument(<span class=\"hljs-string\">'targetDir'<\/span>, help=<span class=\"hljs-string\">'Target directory'<\/span>, nargs=<span class=\"hljs-string\">'?'<\/span>)\n    parser.add_argument(<span class=\"hljs-string\">'-q'<\/span>, <span class=\"hljs-string\">'--quality'<\/span>, type=int, help=<span class=\"hljs-string\">'Save picture quality, default 60'<\/span>)\n    args = parser.parse_args()\n\n    size = args.size\n    sDir = args.sourceDir\n    imageArr = findImg(sDir)\n    tDir = checkTargetDir(sDir,args.targetDir)\n    imgQual = args.quality <span class=\"hljs-keyword\">or<\/span> <span class=\"hljs-number\">60<\/span>\n    <span class=\"hljs-comment\"># \u6267\u884c\u5904\u7406 <\/span>\n    resizeImg(imageArr, size, tDir, imgQual)<\/code><\/pre>\n\n\n\n<h2 id=\"\u8fd0\u884c\u7ed3\u679c\">\u8fd0\u884c\u7ed3\u679c<\/h2>\n\n<p><strong>\u67e5\u770b\u5e2e\u52a9\u4fe1\u606f<\/strong><\/p>\n\n<p><img src=\"http:\/\/img.blog.csdn.net\/20171225183830286?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast\" alt=\"\u5e2e\u52a9\u4fe1\u606f\" title=\"\"><\/p>\n\n<p><strong>\u53ea\u8bbe\u7f6e\u4e86\u6700\u957f\u8fb9\u53c2\u6570\u4ee5\u53ca\u6e90\u76ee\u5f55<\/strong><\/p>\n\n<p><img src=\"http:\/\/img.blog.csdn.net\/20171225184016481?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast\" alt=\"\u53ea\u8bbe\u7f6e\u4e86\u6700\u957f\u8fb9\u53c2\u6570\u4ee5\u53ca\u6e90\u76ee\u5f55\" title=\"\"><\/p>\n\n<p>\u811a\u672c\u4f1a\u63d0\u793a\uff0c\u4e0d\u8bbe\u7f6e\u76ee\u6807\u76ee\u5f55\u5219\u4f1a\u8986\u76d6\u6e90\u6587\u4ef6\uff0c\u76f4\u63a5\u56de\u8f66\uff0c\u6216\u8005\u8f93\u5165 <code>Y<\/code> \u6216\u8005 <code>y<\/code> \u786e\u8ba4\uff0c\u8f93\u5165 <code>N<\/code> \u6216\u8005 <code>n<\/code> \u5219\u9000\u51fa\u7a0b\u5e8f\u3002<\/p>\n\n<p><strong>\u8bbe\u5b9a\u4e86\u76ee\u6807\u76ee\u5f55\uff0c\u4f46\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728<\/strong><\/p>\n\n<p><img src=\"http:\/\/img.blog.csdn.net\/20171225184150955?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast\" alt=\"\u8bbe\u5b9a\u4e86\u76ee\u6807\u76ee\u5f55\uff0c\u4f46\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728\" title=\"\"><\/p>\n\n<p>\u811a\u672c\u4f1a\u63d0\u793a\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u76f4\u63a5\u56de\u8f66\uff0c\u6216\u8005\u8f93\u5165 <code>Y<\/code> \u6216 <code>y<\/code> \u5219\u4f1a\u521b\u5efa\u8fd9\u4e2a\u76ee\u5f55\uff0c\u8f93\u5165 <code>N<\/code> \u6216\u8005 <code>n<\/code> \u5219\u9000\u51fa\u7a0b\u5e8f\u3002<\/p>\n\n<p><strong>\u6b63\u5e38\u4ee5\u53ca\u62a5\u9519\u72b6\u6001<\/strong><\/p>\n\n<p><img src=\"http:\/\/img.blog.csdn.net\/20171225185254190?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast\" alt=\"\u6b63\u5e38\u4ee5\u53ca\u62a5\u9519\u72b6\u6001\" title=\"\"><\/p>\n\n\n\n<h2 id=\"\u4ee3\u7801\u89e3\u6790\">\u4ee3\u7801\u89e3\u6790<\/h2>\n\n<p>\u9996\u5148\uff0c\u8981\u5199\u547d\u4ee4\u884c\u7684\u811a\u672c\uff0c\u5c31\u9700\u8981\u5904\u7406\u5404\u79cd\u5404\u6837\u7684\u53c2\u6570\uff0c\u6240\u4ee5\uff0c<code>argparse<\/code> \u5e93\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002\u5173\u4e8e\u8fd9\u4e2a\u5e93\u7684\u4f7f\u7528\uff0c\u53ef\u4ee5\u770b\u4e0b\u6211\u5b66\u4e60 <code>python<\/code> \u7684\u7b2c\u4e09\u7bc7\u535a\u6587\u7684\u8be6\u7ec6\u4ecb\u7ecd<a href=\"http:\/\/blog.csdn.net\/fungleo\/article\/details\/78784180\" target=\"_blank\">\u300aargparse \u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528\u300b<\/a> \uff0c\u8fd9\u91cc\u6211\u5c31\u4e0d\u8be6\u7ec6\u8bf4\u660e\u4e86\u3002<\/p>\n\n<p><strong>Python os \u5e93\u5bf9\u6587\u4ef6\u5939\u7684\u5e38\u89c1\u7528\u6cd5<\/strong><\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-comment\"># \u5224\u65ad\u76ee\u5f55\u662f\u5426\u5b58\u5728<\/span>\nos.path.exists(__dir__)\n<span class=\"hljs-comment\"># \u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728<\/span>\nos.path.isfile(__file__)\n<span class=\"hljs-comment\"># \u5224\u65ad\u8def\u5f84\u662f\u5426\u4e3a\u6587\u4ef6\u5939<\/span>\nos.path.isdir(__path__)\n<span class=\"hljs-comment\"># \u521b\u5efa\u591a\u5c42\u6587\u4ef6\u5939(\u4e5f\u53ef\u4ee5\u521b\u5efa\u5355\u5c42\u6587\u4ef6\u5939)<\/span>\nos.makedirs(__path__)\n<span class=\"hljs-comment\"># \u6839\u636e\u8def\u5f84\u53d6\u5f97\u6587\u4ef6\u7684\u6587\u4ef6\u540d<\/span>\nos.path.basename(__path__)<\/code><\/pre>\n\n<p>\u66f4\u591a\u53ef\u4ee5\u67e5\u770b\u6587\u6863 <a href=\"https:\/\/docs.python.org\/3\/library\/os.path.html\" target=\"_blank\">https:\/\/docs.python.org\/3\/library\/os.path.html<\/a><\/p>\n\n<p>\u5173\u4e8e\u56fe\u7247\u5904\u7406\uff0c\u53ef\u4ee5\u67e5\u770b <code>python pil<\/code> \u7684\u5b98\u65b9\u6587\u6863 <a href=\"http:\/\/infohost.nmt.edu\/tcc\/help\/pubs\/pil\/pil.pdf\" target=\"_blank\">http:\/\/infohost.nmt.edu\/tcc\/help\/pubs\/pil\/pil.pdf<\/a><\/p>\n\n<p>\u7b80\u5355\u70b9\uff0c\u53ef\u4ee5\u67e5\u770b\u5ed6\u96ea\u5cf0\u7684\u6587\u7ae0 <a href=\"https:\/\/www.liaoxuefeng.com\/wiki\/001374738125095c955c1e6d8bb493182103fac9270762a000\/00140767171357714f87a053a824ffd811d98a83b58ec13000\" target=\"_blank\">https:\/\/www.liaoxuefeng.com\/wiki\/001374738125095c955c1e6d8bb493182103fac9270762a000\/00140767171357714f87a053a824ffd811d98a83b58ec13000<\/a><\/p>\n\n<p>\u56de\u5934\u5c1d\u8bd5\u4e00\u4e0b\u7528 <code>tk<\/code> \u5199\u4e00\u4e2a <code>gui<\/code> \u8fd9\u4e2a\u5de5\u5177\uff0c\u56e0\u4e3a\u786e\u5b9e\u8fd9\u4e2a\u5de5\u5177\u8fd8\u86ee\u5b9e\u7528\u7684\u3002<\/p>\n\n<p>\u66f4\u591a\u5185\u5bb9\u6e90\u7801\u91cc\u9762\u5df2\u7ecf\u6ce8\u91ca\u4e86\u3002<\/p>\n\n<p>\u672c\u6587\u7531 FungLeo \u539f\u521b\uff0c\u5141\u8bb8\u8f6c\u8f7d\uff0c\u4f46\u8f6c\u8f7d\u5fc5\u987b\u4fdd\u7559\u9996\u53d1\u94fe\u63a5\u3002<\/p>","markdowncontent":"# Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff0812\uff09\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u6839\u636e\u8bbe\u5b9a\u6700\u957f\u8fb9\u53c2\u6570\u4fdd\u5b58\u5230\u76ee\u6807\u76ee\u5f55\u811a\u672c\uff08Image \u7684\u4f7f\u7528\uff09\n\n\u5982\u679c\u6211\u4eec\u7ed9\u5ba2\u6237\u5236\u4f5c\u7f51\u7ad9\uff0c\u5ba2\u6237\u4f1a\u53d1\u9001\u8fc7\u6765\u4e00\u5806\u7684\u56fe\u7247\uff0c\u8fd9\u4e9b\u56fe\u7247\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u624b\u673a\u6216\u8005\u6570\u7801\u76f8\u673a\u62cd\u6444\u7684\u3002\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u8fd9\u4e9b\u56fe\u7247\u4f1a\u6bd4\u8f83\u5927\u3002\u90a3\u6211\u4eec\u5c31\u9700\u8981\u5bf9\u8fd9\u4e9b\u56fe\u7247\u8fdb\u884c\u538b\u7f29\u7684\u5904\u7406\uff0c\u8fd9\u5c31\u662f\u6211\u5199\u7684\u8fd9\u4e2a\u811a\u672c\u7684\u5b9e\u9645\u7528\u9014\u3002\n\n\u5173\u952e\u95ee\u9898\u662f\u7b97\u6cd5\uff0c\u4f8b\u5982\uff0c\u6211\u8981\u6c42\u56fe\u7247\u6700\u957f\u8fb9\u4e3a `400px`\uff0c\u90a3\u4e48\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u5904\u7406\u7684\u72b6\u6001\u5e94\u8be5\u662f\uff1a\n\n1. \u6e90\u56fe\u7247\u5c3a\u5bf8\u4e3a `800*600`\uff0c\u5219\u7f29\u653e\u540e\u7ed3\u679c\u662f `400*300`\n2. \u6e90\u56fe\u7247\u5c3a\u5bf8\u4e3a `600*800`\uff0c\u5219\u7f29\u653e\u540e\u7ed3\u679c\u662f `300*400`\n3. \u6e90\u56fe\u7247\u5c3a\u5bf8\u4e3a `300*200`\uff0c\u56e0\u4e3a\u65e0\u8bba\u662f\u5bbd\u548c\u9ad8\u5747\u5c0f\u4e8e\u6211\u4eec\u8bbe\u5b9a\u7684\u6700\u957f\u8fb9\uff0c\u6240\u4ee5\uff0c\u539f\u6837\u4fdd\u5b58\u4e0d\u505a\u5904\u7406\u3002\n\n\u597d\uff0c\u5982\u679c\u6211\u6587\u5b57\u63cf\u8ff0\u4e0d\u8db3\u4ee5\u8ba9\u4f60\u7406\u89e3\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u8be6\u7ec6\u4e3e\u4f8b\uff0c\u6211\u76f8\u4fe1\u5e94\u8be5\u80fd\u7406\u89e3\u6211\u7684\u610f\u56fe\u4e86\u3002\n\n## \u6700\u7ec8\u5b9e\u73b0\u6e90\u7801\n\n```python\n#!\/usr\/bin\/env python3\n# -*- coding: UTF-8 -*-\nimport argparse\nimport os\nimport imghdr\nfrom PIL import Image\n\n# \u9519\u8bef\u9000\u51fa\u51fd\u6570\ndef errMsn(msn):\n    print('\\033[31mError:\\033[0m ' + msn)\n    parser.print_usage()\n    exit()\n\n# \u5728\u6e90\u76ee\u5f55\u4e2d\u627e\u5230\u6240\u6709\u56fe\u7247\u5e76\u8f93\u51fa\u4e3a\u6570\u7ec4\ndef findImg(sdir):\n    res = []\n    if not os.path.exists(sDir):\n        errMsn('Source directory don\\'t exist')\n    for f in os.listdir(sdir):\n        fp = os.path.join(sdir, f)\n        if not os.path.isdir(fp):\n            if imghdr.what(fp):\n                res.append(fp)\n    if len(res) == 0:\n        errMsn('There is no image in the source directory')\n    else:\n        return res\n\n# \u5faa\u73af\u7f29\u653e\u6240\u6709\u56fe\u7247\ndef resizeImg(arr, size, tdir, imgQual):\n    for img in arr:\n        simg = Image.open(img)\n        simg_w = simg.size[0]\n        simg_h = simg.size[1]\n        \n        # \u5982\u679c\u539f\u56fe\u7247\u5bbd\u9ad8\u5747\u5c0f\u4e8e\u8bbe\u7f6e\u5c3a\u5bf8\uff0c\u5219\u5c06\u539f\u56fe\u76f4\u63a5\u590d\u5236\u5230\u76ee\u6807\u76ee\u5f55\u4e2d\n        if simg_w <= size and simg_h <= size:\n            simg.save(tdir + '\/' + os.path.basename(img), quality=imgQual)\n        else:\n            # \u6bd4\u8f83\u6e90\u56fe\u7247\u7684\u5bbd\u9ad8\uff0c\u8ba1\u7b97\u5904\u7406\u540e\u7684\u5bbd\u9ad8\n            timg_w = size\n            timg_h = int(size * simg_h \/ simg_w)\n            if simg_w < simg_h:\n                timg_w = int(size * simg_w \/ simg_h)\n                timg_h = size\n            # \u7f29\u5c0f\u56fe\u7247\u5e76\u4fdd\u5b58\n            timg = simg.resize((timg_w, timg_h),Image.ANTIALIAS)\n            timg.save(tdir + '\/' + os.path.basename(img), quality=imgQual)\n    print('\\033[32mSuccess:\\033[0m Task Finish')\n\n# \u76ee\u6807\u76ee\u5f55\u5904\u7406\u51fd\u6570\ndef checkTargetDir(sdir, tdir):\n    # \u5982\u679c\u76ee\u6807\u76ee\u5f55\u4e3a\u7a7a\u65f6\u63d0\u793a\u7528\u6237\u786e\u8ba4\n    if not tdir:\n        print('\\033[33mWarning:\\033[0m If the target directory isn\\'t set, the processing '\\\n                'results will cover the picture in the source directory\\n'\\\n                '\\033[36mWhether to Continue(Y\/n)\\033[0m ')\n        confirm = input('Confirm:')\n        if confirm in ('', 'Y', 'y'):\n            print('\\033[34mInfo:\\033[0m The target directory is ' + sdir)\n            return sdir\n        else:\n            exit()\n    else:\n        # \u5982\u679c\u76ee\u6807\u76ee\u5f55\u8bbe\u5b9a\uff0c\u4f46\u662f\u4e0d\u5b58\u5728\uff0c\u5219\u63d0\u793a\u7528\u6237\u662f\u5426\u521b\u5efa\u76ee\u6807\u76ee\u5f55\n        if not os.path.exists(tdir):\n            print('Target directory don\\'t exist\\n'\\\n                    '\\033[36mWhether to create the Target directory(Y\/n)\\033[0m')\n            confirm = input('Confirm:')\n            if confirm in ('', 'Y', 'y'):\n                os.makedirs(tdir)\n                return tdir\n            else:\n                exit()\n        else:\n            return tdir\n\nif __name__ == \"__main__\":\n    # \u8bbe\u7f6e\u547d\u4ee4\u884c\u53c2\u6570\n    parser = argparse.ArgumentParser()\n    parser.description='Reduce the picture in the source directory and save it to \\\n            the target directory based on the longest side parameters'\n    parser.add_argument(\"-v\", \"--version\",action='version', version='%(prog)s 1.0')\n    parser.add_argument('size', type=int, help='The max width or max height of a picture')\n    parser.add_argument('sourceDir', help='Source directory')\n    parser.add_argument('targetDir', help='Target directory', nargs='?')\n    parser.add_argument('-q', '--quality', type=int, help='Save picture quality, default 60')\n    args = parser.parse_args()\n\n    size = args.size\n    sDir = args.sourceDir\n    imageArr = findImg(sDir)\n    tDir = checkTargetDir(sDir,args.targetDir)\n    imgQual = args.quality or 60\n    # \u6267\u884c\u5904\u7406 \n    resizeImg(imageArr, size, tDir, imgQual)\n```\n\n## \u8fd0\u884c\u7ed3\u679c\n\n**\u67e5\u770b\u5e2e\u52a9\u4fe1\u606f**\n\n![\u5e2e\u52a9\u4fe1\u606f](http:\/\/img.blog.csdn.net\/20171225183830286?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast)\n\n**\u53ea\u8bbe\u7f6e\u4e86\u6700\u957f\u8fb9\u53c2\u6570\u4ee5\u53ca\u6e90\u76ee\u5f55**\n\n![\u53ea\u8bbe\u7f6e\u4e86\u6700\u957f\u8fb9\u53c2\u6570\u4ee5\u53ca\u6e90\u76ee\u5f55](http:\/\/img.blog.csdn.net\/20171225184016481?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast)\n\n\u811a\u672c\u4f1a\u63d0\u793a\uff0c\u4e0d\u8bbe\u7f6e\u76ee\u6807\u76ee\u5f55\u5219\u4f1a\u8986\u76d6\u6e90\u6587\u4ef6\uff0c\u76f4\u63a5\u56de\u8f66\uff0c\u6216\u8005\u8f93\u5165 `Y` \u6216\u8005 `y` \u786e\u8ba4\uff0c\u8f93\u5165 `N` \u6216\u8005 `n` \u5219\u9000\u51fa\u7a0b\u5e8f\u3002\n\n**\u8bbe\u5b9a\u4e86\u76ee\u6807\u76ee\u5f55\uff0c\u4f46\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728**\n\n![\u8bbe\u5b9a\u4e86\u76ee\u6807\u76ee\u5f55\uff0c\u4f46\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728](http:\/\/img.blog.csdn.net\/20171225184150955?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast)\n\n\u811a\u672c\u4f1a\u63d0\u793a\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u76f4\u63a5\u56de\u8f66\uff0c\u6216\u8005\u8f93\u5165 `Y` \u6216 `y` \u5219\u4f1a\u521b\u5efa\u8fd9\u4e2a\u76ee\u5f55\uff0c\u8f93\u5165 `N` \u6216\u8005 `n` \u5219\u9000\u51fa\u7a0b\u5e8f\u3002\n\n**\u6b63\u5e38\u4ee5\u53ca\u62a5\u9519\u72b6\u6001**\n\n![\u6b63\u5e38\u4ee5\u53ca\u62a5\u9519\u72b6\u6001](http:\/\/img.blog.csdn.net\/20171225185254190?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast)\n\n## \u4ee3\u7801\u89e3\u6790\n\n\u9996\u5148\uff0c\u8981\u5199\u547d\u4ee4\u884c\u7684\u811a\u672c\uff0c\u5c31\u9700\u8981\u5904\u7406\u5404\u79cd\u5404\u6837\u7684\u53c2\u6570\uff0c\u6240\u4ee5\uff0c`argparse` \u5e93\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002\u5173\u4e8e\u8fd9\u4e2a\u5e93\u7684\u4f7f\u7528\uff0c\u53ef\u4ee5\u770b\u4e0b\u6211\u5b66\u4e60 `python` \u7684\u7b2c\u4e09\u7bc7\u535a\u6587\u7684\u8be6\u7ec6\u4ecb\u7ecd[\u300aargparse \u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528\u300b](http:\/\/blog.csdn.net\/fungleo\/article\/details\/78784180) \uff0c\u8fd9\u91cc\u6211\u5c31\u4e0d\u8be6\u7ec6\u8bf4\u660e\u4e86\u3002\n\n\n**Python os \u5e93\u5bf9\u6587\u4ef6\u5939\u7684\u5e38\u89c1\u7528\u6cd5**\n```python\n# \u5224\u65ad\u76ee\u5f55\u662f\u5426\u5b58\u5728\nos.path.exists(__dir__)\n# \u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\nos.path.isfile(__file__)\n# \u5224\u65ad\u8def\u5f84\u662f\u5426\u4e3a\u6587\u4ef6\u5939\nos.path.isdir(__path__)\n# \u521b\u5efa\u591a\u5c42\u6587\u4ef6\u5939(\u4e5f\u53ef\u4ee5\u521b\u5efa\u5355\u5c42\u6587\u4ef6\u5939)\nos.makedirs(__path__)\n# \u6839\u636e\u8def\u5f84\u53d6\u5f97\u6587\u4ef6\u7684\u6587\u4ef6\u540d\nos.path.basename(__path__)\n```\n\n\u66f4\u591a\u53ef\u4ee5\u67e5\u770b\u6587\u6863 https:\/\/docs.python.org\/3\/library\/os.path.html\n\n\u5173\u4e8e\u56fe\u7247\u5904\u7406\uff0c\u53ef\u4ee5\u67e5\u770b `python pil` \u7684\u5b98\u65b9\u6587\u6863 http:\/\/infohost.nmt.edu\/tcc\/help\/pubs\/pil\/pil.pdf\n\n\u7b80\u5355\u70b9\uff0c\u53ef\u4ee5\u67e5\u770b\u5ed6\u96ea\u5cf0\u7684\u6587\u7ae0 https:\/\/www.liaoxuefeng.com\/wiki\/001374738125095c955c1e6d8bb493182103fac9270762a000\/00140767171357714f87a053a824ffd811d98a83b58ec13000\n\n\u56de\u5934\u5c1d\u8bd5\u4e00\u4e0b\u7528 `tk` \u5199\u4e00\u4e2a `gui` \u8fd9\u4e2a\u5de5\u5177\uff0c\u56e0\u4e3a\u786e\u5b9e\u8fd9\u4e2a\u5de5\u5177\u8fd8\u86ee\u5b9e\u7528\u7684\u3002\n\n\u66f4\u591a\u5185\u5bb9\u6e90\u7801\u91cc\u9762\u5df2\u7ecf\u6ce8\u91ca\u4e86\u3002\n\n\u672c\u6587\u7531 FungLeo \u539f\u521b\uff0c\u5141\u8bb8\u8f6c\u8f7d\uff0c\u4f46\u8f6c\u8f7d\u5fc5\u987b\u4fdd\u7559\u9996\u53d1\u94fe\u63a5\u3002\n\n","private":0,"tags":"python,\u811a\u672c,\u56fe\u7247,Image,pil","categories":"python3","channel":"16","type":"original","status":1},"error":"","status":true}