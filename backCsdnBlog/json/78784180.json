{"data":{"id":"78784180","title":"Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff083\uff09argparse \u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528","articleedittype":1,"description":"Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff083\uff09argparse \u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528\u5728\u524d\u9762\u4e00\u7bc7\u535a\u6587\u4e2d http:\/\/blog.csdn.net\/fungleo\/article\/details\/78754419\uff0c \u6211\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7a0b\u5e8f\u2014\u2014\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u3002\u867d\u7136\u5b9e\u73b0\u4e86\u6548\u679c\uff0c\u4f46\u662f\u5176\u4e2d\u5904\u7406\u547d\u4ee4\u884c\u4f20\u5165\u7684\u53c2\u6570\uff0c\u662f\u6211\u81ea\u5df1\u624b\u5199\u5224\u65ad\u7684\u3002\u8fd9\u6837\u505a\u8fd8\u662f\u6709\u7f3a\u70b9\u7684\uff1a\n\u7b28~\u7528 python \u8bed\u8a00\u5c31\u662f\u7528\u5b83\u5404\u79cd\u5404","content":"<h1 id=\"python3-\u521d\u5b66\u5b9e\u8df5\u6848\u4f8b3argparse-\u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528\">Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff083\uff09argparse \u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528<\/h1>\n\n<p>\u5728\u524d\u9762\u4e00\u7bc7\u535a\u6587\u4e2d <a href=\"http:\/\/blog.csdn.net\/fungleo\/article\/details\/78754419\" target=\"_blank\">http:\/\/blog.csdn.net\/fungleo\/article\/details\/78754419<\/a>\uff0c \u6211\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7a0b\u5e8f\u2014\u2014\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u3002<\/p>\n\n<p>\u867d\u7136\u5b9e\u73b0\u4e86\u6548\u679c\uff0c\u4f46\u662f\u5176\u4e2d\u5904\u7406\u547d\u4ee4\u884c\u4f20\u5165\u7684\u53c2\u6570\uff0c\u662f\u6211\u81ea\u5df1\u624b\u5199\u5224\u65ad\u7684\u3002\u8fd9\u6837\u505a\u8fd8\u662f\u6709\u7f3a\u70b9\u7684\uff1a<\/p>\n\n<ol>\n<li>\u7b28~\u7528 <code>python<\/code> \u8bed\u8a00\u5c31\u662f\u7528\u5b83\u5404\u79cd\u5404\u6837\u725b\u903c\u7684\u5e93<\/li>\n<li>\u53c2\u6570\u7684\u4f4d\u7f6e\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u80fd\u653e\u5728\u524d\u9762<\/li>\n<li>\u5982\u679c\u8981\u5b9e\u73b0\u4e0a\u4e00\u6761\uff0c\u6211\u7684\u624b\u5199\u7684\u4ee3\u7801\u90e8\u5206\u7684\u590d\u6742\u5ea6\u5c06\u8981\u5927\u5927\u63d0\u9ad8<\/li>\n<li>\u60f3\u8981\u66f4\u591a\u529f\u80fd\uff0c\u5c31\u5f97\u66f4\u590d\u6742\uff0c\u6211\u8868\u793a\u65e0\u80fd\u4e3a\u529b<\/li>\n<\/ol>\n\n<p>\u6240\u4ee5\uff0c\u6211\u627e\u4e00\u4e0b\u6709\u6ca1\u6709\u5408\u9002\u7684\u5e93\u6765\u505a\u8fd9\u4e2a\uff0c\u6709\u597d\u4e9b\u7684\u8fd8\u662f\u3002\u6700\u7ec8\u6211\u9009\u62e9\u4e86\u81ea\u5e26\u7684\u6bd4\u8f83\u65b0\u7684 <code>argparse<\/code> \u5e93\u3002\u8fd8\u6709\u7b2c\u4e09\u65b9\u7684\u66f4\u7b80\u6d01\u7684\u5e93\uff0c\u4e0d\u8fc7\u6211\u6ca1\u6709\u4f7f\u7528\u3002<\/p>\n\n\n\n<h2 id=\"argparse-\u4f7f\u7528\u7b80\u5355\u8bf4\u660e\">argparse \u4f7f\u7528\u7b80\u5355\u8bf4\u660e<\/h2>\n\n<p><code>argparse<\/code> \u5e93\u529f\u80fd\u6bd4\u8f83\u5f3a\u5927\uff0c\u5b98\u65b9\u4e2d\u6587\u7248\u8d44\u6599\u89c1\uff1a<a href=\"http:\/\/python.usyiyi.cn\/translate\/python_278\/library\/argparse.html\" target=\"_blank\">http:\/\/python.usyiyi.cn\/translate\/python_278\/library\/argparse.html<\/a><\/p>\n\n<p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6559\u7a0b\u91cc\u9762\u7684\u8bed\u6cd5\u662f <code>python2<\/code> \u7684\uff0c\u800c\u6211\u4eec\u73b0\u5728\u4e00\u822c\u5b66\u4e60\u7684\u90fd\u662f <code>python3<\/code> \u5427~<\/p>\n\n<p><strong>\u5f15\u7528 <code>argparse<\/code> \u5e93<\/strong><\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-keyword\">import<\/span> argparse<\/code><\/pre>\n\n<p>\u5c31\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u5f15\u7528\u4e86\u3002\u975e\u5e38\u7b80\u5355\u3002<\/p>\n\n<p>\u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u5206\u6790\u5668<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser = argparse.ArgumentParser()<\/code><\/pre>\n\n<p>\u5b98\u65b9\u6559\u7a0b\u5c31\u662f\u8fd9\u4e48\u5199\u7684\uff0c\u6211\u7c97\u6d45\u7684\u8ba4\u4e3a\uff0c\u8fd9\u662f\u4e3a\u4e86\u8ba9\u4ee3\u7801\u53d8\u5f97\u77ed\u4e00\u4e9b\u3002<\/p>\n\n<p>\u5b9a\u4e49\u5206\u6790\u5668\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f80\u91cc\u9762\u6dfb\u52a0\u6211\u4eec\u9700\u8981\u7684\u53c2\u6570\u3002<\/p>\n\n<p><strong>\u4e3a\u6211\u4eec\u7684\u811a\u672c\u6dfb\u52a0\u4e00\u4e2a\u8bf4\u660e\u63cf\u8ff0<\/strong><\/p>\n\n<p>\u9996\u5148\u5462\uff0c\u6211\u4eec\u7684\u811a\u672c\u662f\u5e72\u5565\u7684\uff0c\u5f97\u5148\u63cf\u8ff0\u4e00\u4e0b\u3002\u5b98\u65b9\u7684\u4ee3\u7801\u5982\u4e0b\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser = argparse.ArgumentParser(description=<span class=\"hljs-string\">'\u8fd9\u91cc\u5199\u70b9\u63cf\u8ff0\u4fe1\u606f'<\/span>)<\/code><\/pre>\n\n<p>\u6211\u4e0d\u592a\u559c\u6b22\u8fd9\u79cd\u5199\u6cd5\u3002\u4e8e\u662f\uff0c\u6211\u662f\u8fd9\u6837\u5199\u7684\u3002<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser = argparse.ArgumentParser()\nparser.description=<span class=\"hljs-string\">'\u8fd9\u91cc\u5199\u70b9\u63cf\u8ff0\u4fe1\u606f'<\/span><\/code><\/pre>\n\n<p>\u6548\u679c\u6ca1\u5dee\u3002<\/p>\n\n<p><strong>\u8bbe\u7f6e <code>-v<\/code> \u4e3a\u8f93\u51fa\u7a0b\u5e8f\u7248\u672c\u53f7<\/strong><\/p>\n\n<p>\u597d\uff0c\u63cf\u8ff0\u597d\u4e86\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u5e94\u8be5\u662f\u4f1a\u7248\u672c\u5347\u7ea7\u7684\u3002\u6240\u4ee5\u5462\uff0c\u7248\u672c\u53f7\u5f88\u6709\u5fc5\u8981\u3002<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser.add_argument(<span class=\"hljs-string\">\"-v\"<\/span>, <span class=\"hljs-string\">\"--version\"<\/span>,action=<span class=\"hljs-string\">'version'<\/span>, version=<span class=\"hljs-string\">'%(prog)s 1.0'<\/span>)<\/code><\/pre>\n\n<p>\u5982\u4e0a\uff0c\u914d\u7f6e\u53c2\u6570 <code>action<\/code> \u7684\u503c\u4e3a <code>version<\/code> \u5c31\u53ef\u4ee5\u4e86\u3002\u540e\u9762\u7684 <code>%(prog)s<\/code> \u4ee3\u8868\u4f60\u81ea\u5df1\u7684\u811a\u672c\u7684\u540d\u79f0\u3002\u8fd9\u4e2a\u662f\u53ef\u53d8\u7684\u3002\u5e76\u4e14\u662f\u53ef\u4ee5\u8bbe\u7f6e\u7684\u3002<\/p>\n\n<p><strong>\u6dfb\u52a0\u4e00\u4e2a\u5fc5\u586b\u7684\u53c2\u6570<\/strong><\/p>\n\n<p>\u6211\u4eec\u7528 <code>parser.add_argument<\/code> \u6765\u5f80\u5206\u6790\u5668\u91cc\u9762\u6dfb\u52a0\u53c2\u6570\uff0c\u4e0a\u9762\u6211\u4eec\u5df2\u7ecf\u6dfb\u52a0\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u7248\u6743\u8f93\u51fa\u7684\u53c2\u6570\u3002\u90a3\u4e48\u6b63\u5e38\u7684\u6dfb\u52a0\u666e\u901a\u53c2\u6570\uff0c\u5c31\u662f\u4e0b\u9762\u7684\u65b9\u6cd5\u4e86\u3002<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser.add_argument(<span class=\"hljs-string\">'sourceDir'<\/span>, help=<span class=\"hljs-string\">'Select source directory'<\/span>)<\/code><\/pre>\n\n<p>\u5982\u4e0a\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5fc5\u586b\u7684\u53c2\u6570 <code>sourceDir<\/code> \uff0c\u540e\u9762\u7684 <em>help<\/em> \u662f\u5e2e\u52a9\u4fe1\u606f\uff0c\u9ed8\u8ba4\u7684\u53c2\u6570\u683c\u5f0f\u662f\u5b57\u7b26\u4e32\uff0c\u4e5f\u5c31\u662f <code>str<\/code> \u5982\u679c\u4f60\u9700\u8981\u53c2\u6570\u662f\u5176\u4ed6\u5185\u5bb9\uff0c\u9700\u8981\u6307\u5b9a <code>type<\/code>\u3002\u4f8b\u5982\uff0c\u4f60\u9700\u8981\u7684\u53c2\u6570\u662f\u6570\u5b57\uff0c\u5c31\u9700\u8981\u7528 <code>type=int<\/code> \u6765\u6307\u5b9a\u7c7b\u578b\u3002<\/p>\n\n<p><strong>\u6dfb\u52a0\u4e00\u4e2a\u4e0d\u5e26<code>-<\/code>\u524d\u7f00\u7684\u9009\u586b\u7684\u53c2\u6570<\/strong><\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser.add_argument(<span class=\"hljs-string\">'targetDir'<\/span>, help=<span class=\"hljs-string\">'Select target directory'<\/span>, nargs=<span class=\"hljs-string\">'?'<\/span>)<\/code><\/pre>\n\n<p>\u5982\u4e0a\uff0c\u4f7f\u7528 <code>nargs='?'<\/code> \u5c31\u53ef\u4ee5\u4f7f\u8fd9\u4e2a\u53c2\u6570\u662f\u9009\u586b\u7684\u3002\u5b83\u8fd8\u6709\u5176\u4ed6\u7684\u503c\uff0c\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002\u6211\u8fd9\u91cc\u4f7f\u7528\u95ee\u53f7\u8868\u793a\u53ef\u4ee5\u63a5\u65360\u4e2a\uff08\u4e5f\u5c31\u662f\u4e0d\u586b\uff09\u6216\u80051\u4e2a\uff08\u4e5f\u5c31\u662f\u53ef\u4ee5\u586b\uff09\u503c\u3002<\/p>\n\n<p><strong>\u6dfb\u52a0\u4e00\u4e2a\u5e26 <code>-<\/code> \u524d\u7f00\u7684\u9009\u586b\u53c2\u6570<\/strong><\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">parser.add_argument(<span class=\"hljs-string\">\"-a\"<\/span>, <span class=\"hljs-string\">\"--add\"<\/span>, help=<span class=\"hljs-string\">\"add something\"<\/span>)<\/code><\/pre>\n\n<p>\u4ee3\u7801\u5982\u4e0a\uff0c\u53ea\u9700\u8981\u52a0\u4e0a <code>-<\/code> \u524d\u7f00\uff0c\u90a3\u4e48\u5c31\u8868\u793a\u8fd9\u4e2a\u53c2\u6570\u662f\u9009\u586b\u4e86\u7684\u3002\u5e76\u4e14\u53ef\u4ee5\u540c\u65f6\u6307\u5b9a\u7b80\u5199\u6216\u8005\u53cc\u6a2a\u7ebf\u7684\u5168\u62fc\uff0c\u4e5f\u53ef\u4ee5\u53ea\u6307\u5b9a\u4e00\u4e2a\u3002\u6839\u636e\u4f60\u81ea\u5df1\u7684\u9700\u8981\u6765\u8fdb\u884c\u8bbe\u7f6e\u3002<\/p>\n\n<p><strong>\u6dfb\u52a0\u4e00\u4e2a\u4e92\u76f8\u6392\u65a5\u7684\u4e8c\u9009\u4e00\u7684\u9009\u586b\u53c2\u6570<\/strong><\/p>\n\n<p>\u4e0a\u9762\u6dfb\u52a0\u7684\u8fd9\u4e9b\u53c2\u6570\u662f\u53ef\u4ee5\u6ee1\u8db3\u5f88\u591a\u573a\u666f\uff0c\u4f46\u662f\u4e00\u4e2a\u573a\u666f\u6ee1\u8db3\u4e0d\u4e86\uff0c\u6bd4\u5982\uff0c\u6211\u9700\u8981 <code>-m | -c<\/code> \u8fd9\u4e24\u4e2a\u53c2\u6570\u53ea\u80fd\u51fa\u73b0\u4e00\u4e2a\uff0c\u5982\u679c\u540c\u65f6\u51fa\u73b0\u4e24\u4e2a\u5c31\u4e0d\u884c\u3002\u90a3\u4e48\u4e0a\u9762\u7684\u65b9\u6cd5\u5c31\u4e0d\u591f\u7528\u4e86\u3002<\/p>\n\n<p>\u6211\u4eec\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u6765\u8fdb\u884c\u5b9e\u73b0\u3002<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">group = parser.add_mutually_exclusive_group()\ngroup.add_argument(<span class=\"hljs-string\">\"-m\"<\/span>, <span class=\"hljs-string\">\"--move\"<\/span>, help=<span class=\"hljs-string\">\"The way to operate the file is to move\"<\/span>, action=<span class=\"hljs-string\">\"store_true\"<\/span>)\ngroup.add_argument(<span class=\"hljs-string\">\"-c\"<\/span>, <span class=\"hljs-string\">\"--copy\"<\/span>, help=<span class=\"hljs-string\">\"The way to operate the file is to copy\"<\/span>, action=<span class=\"hljs-string\">\"store_true\"<\/span>)<\/code><\/pre>\n\n<p>\u5982\u4e0a\uff0c\u5b9a\u4e49\u4e00\u4e2a\u53c2\u6570\u7ec4 <code>group<\/code> \u7136\u540e\u5f80\u8fd9\u4e2a\u7ec4\u91cc\u6dfb\u52a0\u4e0d\u540c\u529f\u80fd\u7684\u53c2\u6570\u5373\u53ef\u3002<\/p>\n\n<p><code>action=\"store_true\"<\/code> \u8fd9\u4e2a\u914d\u7f6e\u9879\u4ee3\u8868\u8fd9\u4e2a\u4e0d\u9700\u8981\u586b\u5199\u503c\uff0c\u76f4\u63a5\u5199\u53c2\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\u8f93\u51fa\u7684\u65f6\u5019\u4e3a\u5e03\u5c14\u503c\u3002<\/p>\n\n<p><strong>\u83b7\u53d6\u6240\u6709\u7684\u53c2\u6570<\/strong><\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">args = parser.parse_args()\nprint(args)<\/code><\/pre>\n\n<p>\u597d\uff0c\u5982\u4e0a\u4ee3\u7801\uff0c\u6211\u4eec\u5c31\u628a\u53c2\u6570\u5b9a\u4e49\u4e3a\u53d8\u91cf <code>args<\/code> \u4e86\uff0c\u7136\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u5bf9\u8c61\u6765\u83b7\u53d6\u6211\u4eec\u7684\u5404\u79cd\u53c2\u6570\u4e86\u3002<\/p>\n\n<p><strong>\u6253\u5370\u5e2e\u52a9\u4fe1\u606f<\/strong><\/p>\n\n<p>\u6211\u4eec\u5728\u7a0b\u5e8f\u540e\u9762\u52a0\u4e0a <code>-h<\/code> \u8fd9\u4e2a\u53c2\u6570\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6211\u4eec\u7684\u7a0b\u5e8f\u7684\u8be6\u7ec6\u7684\u5e2e\u52a9\u4fe1\u606f\u3002\u8fd9\u4e2a\u662f <code>argparse<\/code> \u81ea\u5e26\u7684\u725b\u903c\u529f\u80fd\u3002\u7701\u5f97\u6211\u4eec\u81ea\u5df1\u53bb\u6784\u5efa\u5e2e\u52a9\u4fe1\u606f\uff0c\u6211\u8868\u793a\u975e\u5e38\u559c\u6b22\u3002<\/p>\n\n<p>\u4f46\u662f\u5982\u679c\u53ea\u6709\u8fd9\u6837\u624d\u80fd\u83b7\u53d6\u5e2e\u52a9\u4fe1\u606f\uff0c\u90a3\u4e48\u6709\u70b9\u7d22\u7136\u65e0\u5473\u4e86\u3002\u5176\u5b9e\uff0c <code>argparse<\/code> \u5185\u7f6e\u4e86\u4e00\u4e9b\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8ba9\u6211\u4eec\u8c03\u7528\u5e2e\u52a9\u4fe1\u606f<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-comment\"># \u6253\u5370 usage<\/span>\nparser.print_usage()\n<span class=\"hljs-comment\"># \u6253\u5370\u5b8c\u6574\u7684 help \u4fe1\u606f<\/span>\nparser.print_help()\n<span class=\"hljs-comment\"># \u8f93\u51fa usage<\/span>\nparser.format_usage()\n<span class=\"hljs-comment\"># \u8f93\u51fa help<\/span>\nparser.format_help()<\/code><\/pre>\n\n<p>\u6253\u5370\u548c\u8f93\u51fa\u7684\u533a\u522b\u662f\uff0c\u6253\u5370\u5c31\u76f4\u63a5\u6253\u51fa\u6765\u4e86\u3002\u8f93\u51fa\u7684\u8bdd\uff0c\u53ea\u662f\u8f93\u51fa\uff0c\u4f60\u53ef\u4ee5\u62ff\u6765\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f8b\u5982\uff0c\u4f60\u60f3\u8f93\u51fa\u4e86\u4e4b\u540e\u518d\u6253\u5370\u51fa\u6765\u5c31\u53ef\u4ee5\u5982\u4e0b\u6267\u884c\uff1a<\/p>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \">print(parser.format_help())<\/code><\/pre>\n\n<p>\u597d\u5427\uff0c\u6709\u70b9\u8131\u88e4\u5b50\u653e\u5c41\u7684\u610f\u601d\u3002\u4e0d\u8fc7\u4f60\u660e\u767d\u6211\u60f3\u8868\u8fbe\u4ec0\u4e48\u4e86\u3002<\/p>\n\n\n\n<h2 id=\"\u4f18\u5316\u8fc7\u7684\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528md5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u6e90\u4ee3\u7801\">\u4f18\u5316\u8fc7\u7684\u201c\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u201d\u6e90\u4ee3\u7801<\/h2>\n\n\n\n<pre class=\"prettyprint\"><code class=\"language-python hljs \"><span class=\"hljs-comment\">#!\/usr\/bin\/env python3<\/span>\n<span class=\"hljs-comment\"># -*- coding: UTF-8 -*-<\/span>\n<span class=\"hljs-keyword\">import<\/span> os\n<span class=\"hljs-comment\"># \u83b7\u53d6\u6587\u4ef6\u7c7b\u578b\u5e93<\/span>\n<span class=\"hljs-keyword\">import<\/span> imghdr\n<span class=\"hljs-comment\"># MD5\u5e93<\/span>\n<span class=\"hljs-keyword\">import<\/span> hashlib\n<span class=\"hljs-comment\"># \u6587\u4ef6\u64cd\u4f5c\u5e93<\/span>\n<span class=\"hljs-keyword\">import<\/span> shutil\n<span class=\"hljs-comment\"># \u547d\u4ee4\u884c\u5206\u6790\u5e93<\/span>\n<span class=\"hljs-keyword\">import<\/span> argparse\n\n<span class=\"hljs-comment\"># \u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528 argparse \u5e93<\/span>\nparser = argparse.ArgumentParser()\n<span class=\"hljs-comment\"># \u5b9a\u4e49\u811a\u672c\u63cf\u8ff0\u4fe1\u606f<\/span>\nparser.description=<span class=\"hljs-string\">'Move or copy the images in the source directory with the name of MD5 into the target directory'<\/span>\n<span class=\"hljs-comment\"># \u5b9a\u4e49\u811a\u672c\u7248\u672c<\/span>\nparser.add_argument(<span class=\"hljs-string\">\"-v\"<\/span>, <span class=\"hljs-string\">\"--version\"<\/span>,action=<span class=\"hljs-string\">'version'<\/span>, version=<span class=\"hljs-string\">'%(prog)s 1.0'<\/span>)\n\n<span class=\"hljs-comment\"># \u6dfb\u52a0\u6e90\u76ee\u5f55\u53c2\u6570\uff0c\u5fc5\u586b<\/span>\nparser.add_argument(<span class=\"hljs-string\">'sourceDir'<\/span>, help=<span class=\"hljs-string\">'Select source directory'<\/span>)\n<span class=\"hljs-comment\"># \u6dfb\u52a0\u76ee\u6807\u76ee\u5f55\u53c2\u6570\uff0c\u9009\u586b<\/span>\nparser.add_argument(<span class=\"hljs-string\">'targetDir'<\/span>, help=<span class=\"hljs-string\">'Select target directory'<\/span>, nargs=<span class=\"hljs-string\">'?'<\/span>)\n\n<span class=\"hljs-comment\"># \u5b9a\u4e49\u4e00\u4e2a\u4e92\u76f8\u6392\u65a5\u7684\u53c2\u6570\uff0ccopy or move \u4e0d\u53ef\u540c\u65f6\u5b58\u5728<\/span>\ngroup = parser.add_mutually_exclusive_group()\ngroup.add_argument(<span class=\"hljs-string\">\"-m\"<\/span>, <span class=\"hljs-string\">\"--move\"<\/span>, help=<span class=\"hljs-string\">\"The way to operate the file is to move\"<\/span>, action=<span class=\"hljs-string\">\"store_true\"<\/span>)\ngroup.add_argument(<span class=\"hljs-string\">\"-c\"<\/span>, <span class=\"hljs-string\">\"--copy\"<\/span>, help=<span class=\"hljs-string\">\"The way to operate the file is to copy\"<\/span>, action=<span class=\"hljs-string\">\"store_true\"<\/span>)\n\n<span class=\"hljs-comment\"># \u5c06\u53c2\u6570\u547d\u540d\u4e3a\u53d8\u91cf args<\/span>\nargs = parser.parse_args()\n\n<span class=\"hljs-comment\"># \u8bbe\u5b9a\u9ed8\u8ba4\u53c2\u6570<\/span>\nsourceDir = args.sourceDir\ntargetDir = args.targetDir <span class=\"hljs-keyword\">or<\/span> args.sourceDir\noperation = <span class=\"hljs-string\">'copy'<\/span> <span class=\"hljs-keyword\">if<\/span> args.copy == <span class=\"hljs-keyword\">True<\/span> <span class=\"hljs-keyword\">else<\/span> <span class=\"hljs-string\">'move'<\/span>\nimages = []\n\n<span class=\"hljs-comment\"># \u5b9a\u4e49\u51fa\u9519\u51fd\u6570<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">errUsage<\/span><span class=\"hljs-params\">(res)<\/span>:<\/span>\n    print(<span class=\"hljs-string\">'error: '<\/span> + res)\n    parser.print_usage()\n    exit()\n\n<span class=\"hljs-comment\"># \u627e\u5230\u6e90\u76ee\u5f55\u4e0b\u6240\u6709\u7684\u56fe\u7247<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">findImage<\/span><span class=\"hljs-params\">(sourceDir)<\/span>:<\/span>\n    <span class=\"hljs-comment\"># \u5982\u679c\u6e90\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u5219\u62a5\u9519\u9000\u51fa<\/span>\n    <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> os.path.exists(sourceDir):\n        errUsage(<span class=\"hljs-string\">'Source directory is not defined'<\/span>)\n    <span class=\"hljs-comment\"># \u5faa\u73af\u76ee\u6807\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6<\/span>\n    <span class=\"hljs-keyword\">for<\/span> fil <span class=\"hljs-keyword\">in<\/span> os.listdir(sourceDir):\n        <span class=\"hljs-comment\"># \u53d6\u5f97\u6587\u4ef6\u7684\u8def\u5f84<\/span>\n        filPath = os.path.join(sourceDir, fil)\n        <span class=\"hljs-comment\"># \u5224\u65ad\u6587\u4ef6\u662f\u5426\u4e3a\u76ee\u5f55<\/span>\n        <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> os.path.isdir(filPath):\n            <span class=\"hljs-comment\"># \u5224\u65ad\u6587\u4ef6\u662f\u5426\u4e3a\u56fe\u7247<\/span>\n            <span class=\"hljs-keyword\">if<\/span> imghdr.what(filPath) != <span class=\"hljs-keyword\">None<\/span>:\n                <span class=\"hljs-comment\"># \u5c06\u56fe\u7247\u63d2\u5165\u9700\u8981\u5904\u7406\u7684\u5217\u8868<\/span>\n                images.append(filPath)\n<span class=\"hljs-comment\"># \u8ba1\u7b97 MD5 \u503c\u51fd\u6570<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">calcMD5<\/span><span class=\"hljs-params\">(filepath)<\/span>:<\/span>\n    <span class=\"hljs-keyword\">with<\/span> open(filepath,<span class=\"hljs-string\">'rb'<\/span>) <span class=\"hljs-keyword\">as<\/span> f:\n        md5obj = hashlib.md5()\n        md5obj.update(f.read())\n        hash = md5obj.hexdigest()\n        <span class=\"hljs-keyword\">return<\/span> hash\n\n<span class=\"hljs-comment\"># \u5904\u7406\u6240\u6709\u56fe\u7247<\/span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def<\/span> <span class=\"hljs-title\">md5img<\/span><span class=\"hljs-params\">(images)<\/span>:<\/span>\n    <span class=\"hljs-comment\"># \u5982\u679c\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u5219\u62a5\u9519\u9000\u51fa<\/span>\n    <span class=\"hljs-keyword\">if<\/span> <span class=\"hljs-keyword\">not<\/span> os.path.exists(targetDir):\n        errUsage(<span class=\"hljs-string\">'Target directory is not defined'<\/span>)\n\n    method = {\n        <span class=\"hljs-string\">\"move\"<\/span>: shutil.move,\n        <span class=\"hljs-string\">\"copy\"<\/span>: shutil.copy\n    }\n    <span class=\"hljs-comment\"># \u5faa\u73af\u9700\u8981\u5904\u7406\u7684\u56fe\u7247\u5217\u8868<\/span>\n    <span class=\"hljs-keyword\">for<\/span> img <span class=\"hljs-keyword\">in<\/span> images:\n        <span class=\"hljs-comment\"># \u6839\u636e\u56fe\u7247\u7684\u771f\u5b9e\u540e\u7f00\uff0c\u6765\u786e\u5b9a\u56fe\u7247\u7684\u540e\u7f00\uff0c\u5982\u679c\u662f jpeg \u5219\u6539\u6210 jpg<\/span>\n        postfix = <span class=\"hljs-string\">'jpg'<\/span> <span class=\"hljs-keyword\">if<\/span> imghdr.what(img) == <span class=\"hljs-string\">'jpeg'<\/span> <span class=\"hljs-keyword\">else<\/span> imghdr.what(img)\n        <span class=\"hljs-comment\"># \u6267\u884c\u590d\u5236\u6216\u8005\u79fb\u52a8\u64cd\u4f5c<\/span>\n        method[operation](img, targetDir + <span class=\"hljs-string\">'\/'<\/span> + calcMD5(img) + <span class=\"hljs-string\">'.'<\/span> + postfix)\n<span class=\"hljs-comment\"># \u627e\u56fe\u7247<\/span>\nfindImage(sourceDir)\n<span class=\"hljs-comment\"># \u5904\u7406\u56fe\u7247<\/span>\nmd5img(images)\n<span class=\"hljs-comment\"># \u5b8c\u6210<\/span>\nprint(<span class=\"hljs-string\">'Finish'<\/span>)<\/code><\/pre>\n\n<p>\u4ee3\u7801\u4e2d\u5df2\u7ecf\u6dfb\u52a0\u4e86\u5f88\u591a\u7684\u6ce8\u91ca\u4e86\uff0c\u5e94\u8be5\u6765\u8bf4\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u770b\u61c2\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002<\/p>\n\n<p>\u7a0b\u5e8f\u6267\u884c\u6548\u679c\u5982\u4e0b\u56fe\u6240\u793a\uff1a<\/p>\n\n<p><img src=\"http:\/\/img.blog.csdn.net\/20171212172932800?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast\" alt=\"\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\" title=\"\"><\/p>\n\n<p>OK\uff0c\u7ec8\u4e8e\u628a\u8fd9\u4e2a\u811a\u672c\u7ed9\u5199\u5f97\u76f8\u5bf9\u6765\u8bf4\u6ee1\u610f\u4e86\u3002<\/p>\n\n<p>\u672c\u6587\u7531 FungLeo \u539f\u521b\uff0c\u5141\u8bb8\u8f6c\u8f7d\uff0c\u4f46\u8f6c\u8f7d\u5fc5\u987b\u4fdd\u7559\u9996\u53d1\u94fe\u63a5\u3002<\/p>","markdowncontent":"# Python3 \u521d\u5b66\u5b9e\u8df5\u6848\u4f8b\uff083\uff09argparse \u547d\u4ee4\u884c\u53c2\u6570\u5e93\u7684\u4f7f\u7528\n\n\u5728\u524d\u9762\u4e00\u7bc7\u535a\u6587\u4e2d http:\/\/blog.csdn.net\/fungleo\/article\/details\/78754419\uff0c \u6211\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7a0b\u5e8f\u2014\u2014\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u3002\n\n\u867d\u7136\u5b9e\u73b0\u4e86\u6548\u679c\uff0c\u4f46\u662f\u5176\u4e2d\u5904\u7406\u547d\u4ee4\u884c\u4f20\u5165\u7684\u53c2\u6570\uff0c\u662f\u6211\u81ea\u5df1\u624b\u5199\u5224\u65ad\u7684\u3002\u8fd9\u6837\u505a\u8fd8\u662f\u6709\u7f3a\u70b9\u7684\uff1a\n\n1. \u7b28~\u7528 `python` \u8bed\u8a00\u5c31\u662f\u7528\u5b83\u5404\u79cd\u5404\u6837\u725b\u903c\u7684\u5e93\n2. \u53c2\u6570\u7684\u4f4d\u7f6e\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u80fd\u653e\u5728\u524d\u9762\n3. \u5982\u679c\u8981\u5b9e\u73b0\u4e0a\u4e00\u6761\uff0c\u6211\u7684\u624b\u5199\u7684\u4ee3\u7801\u90e8\u5206\u7684\u590d\u6742\u5ea6\u5c06\u8981\u5927\u5927\u63d0\u9ad8\n4. \u60f3\u8981\u66f4\u591a\u529f\u80fd\uff0c\u5c31\u5f97\u66f4\u590d\u6742\uff0c\u6211\u8868\u793a\u65e0\u80fd\u4e3a\u529b\n\n\u6240\u4ee5\uff0c\u6211\u627e\u4e00\u4e0b\u6709\u6ca1\u6709\u5408\u9002\u7684\u5e93\u6765\u505a\u8fd9\u4e2a\uff0c\u6709\u597d\u4e9b\u7684\u8fd8\u662f\u3002\u6700\u7ec8\u6211\u9009\u62e9\u4e86\u81ea\u5e26\u7684\u6bd4\u8f83\u65b0\u7684 `argparse` \u5e93\u3002\u8fd8\u6709\u7b2c\u4e09\u65b9\u7684\u66f4\u7b80\u6d01\u7684\u5e93\uff0c\u4e0d\u8fc7\u6211\u6ca1\u6709\u4f7f\u7528\u3002\n\n## argparse \u4f7f\u7528\u7b80\u5355\u8bf4\u660e\n\n`argparse` \u5e93\u529f\u80fd\u6bd4\u8f83\u5f3a\u5927\uff0c\u5b98\u65b9\u4e2d\u6587\u7248\u8d44\u6599\u89c1\uff1ahttp:\/\/python.usyiyi.cn\/translate\/python_278\/library\/argparse.html\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6559\u7a0b\u91cc\u9762\u7684\u8bed\u6cd5\u662f `python2` \u7684\uff0c\u800c\u6211\u4eec\u73b0\u5728\u4e00\u822c\u5b66\u4e60\u7684\u90fd\u662f `python3` \u5427~\n\n**\u5f15\u7528 `argparse` \u5e93**\n\n```python\nimport argparse\n```\n\n\u5c31\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u5f15\u7528\u4e86\u3002\u975e\u5e38\u7b80\u5355\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u5206\u6790\u5668\n\n```python\nparser = argparse.ArgumentParser()\n```\n\n\u5b98\u65b9\u6559\u7a0b\u5c31\u662f\u8fd9\u4e48\u5199\u7684\uff0c\u6211\u7c97\u6d45\u7684\u8ba4\u4e3a\uff0c\u8fd9\u662f\u4e3a\u4e86\u8ba9\u4ee3\u7801\u53d8\u5f97\u77ed\u4e00\u4e9b\u3002\n\n\u5b9a\u4e49\u5206\u6790\u5668\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f80\u91cc\u9762\u6dfb\u52a0\u6211\u4eec\u9700\u8981\u7684\u53c2\u6570\u3002\n\n**\u4e3a\u6211\u4eec\u7684\u811a\u672c\u6dfb\u52a0\u4e00\u4e2a\u8bf4\u660e\u63cf\u8ff0**\n\n\u9996\u5148\u5462\uff0c\u6211\u4eec\u7684\u811a\u672c\u662f\u5e72\u5565\u7684\uff0c\u5f97\u5148\u63cf\u8ff0\u4e00\u4e0b\u3002\u5b98\u65b9\u7684\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```python\nparser = argparse.ArgumentParser(description='\u8fd9\u91cc\u5199\u70b9\u63cf\u8ff0\u4fe1\u606f')\n```\n\n\u6211\u4e0d\u592a\u559c\u6b22\u8fd9\u79cd\u5199\u6cd5\u3002\u4e8e\u662f\uff0c\u6211\u662f\u8fd9\u6837\u5199\u7684\u3002\n\n```python\nparser = argparse.ArgumentParser()\nparser.description='\u8fd9\u91cc\u5199\u70b9\u63cf\u8ff0\u4fe1\u606f'\n```\n\n\u6548\u679c\u6ca1\u5dee\u3002\n\n**\u8bbe\u7f6e `-v` \u4e3a\u8f93\u51fa\u7a0b\u5e8f\u7248\u672c\u53f7**\n\n\u597d\uff0c\u63cf\u8ff0\u597d\u4e86\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u5e94\u8be5\u662f\u4f1a\u7248\u672c\u5347\u7ea7\u7684\u3002\u6240\u4ee5\u5462\uff0c\u7248\u672c\u53f7\u5f88\u6709\u5fc5\u8981\u3002\n\n```python\nparser.add_argument(\"-v\", \"--version\",action='version', version='%(prog)s 1.0')\n```\n\n\u5982\u4e0a\uff0c\u914d\u7f6e\u53c2\u6570 `action` \u7684\u503c\u4e3a `version` \u5c31\u53ef\u4ee5\u4e86\u3002\u540e\u9762\u7684 `%(prog)s` \u4ee3\u8868\u4f60\u81ea\u5df1\u7684\u811a\u672c\u7684\u540d\u79f0\u3002\u8fd9\u4e2a\u662f\u53ef\u53d8\u7684\u3002\u5e76\u4e14\u662f\u53ef\u4ee5\u8bbe\u7f6e\u7684\u3002\n\n**\u6dfb\u52a0\u4e00\u4e2a\u5fc5\u586b\u7684\u53c2\u6570**\n\n\u6211\u4eec\u7528 `parser.add_argument` \u6765\u5f80\u5206\u6790\u5668\u91cc\u9762\u6dfb\u52a0\u53c2\u6570\uff0c\u4e0a\u9762\u6211\u4eec\u5df2\u7ecf\u6dfb\u52a0\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u7248\u6743\u8f93\u51fa\u7684\u53c2\u6570\u3002\u90a3\u4e48\u6b63\u5e38\u7684\u6dfb\u52a0\u666e\u901a\u53c2\u6570\uff0c\u5c31\u662f\u4e0b\u9762\u7684\u65b9\u6cd5\u4e86\u3002\n\n```python\nparser.add_argument('sourceDir', help='Select source directory')\n```\n\n\u5982\u4e0a\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5fc5\u586b\u7684\u53c2\u6570 `sourceDir` \uff0c\u540e\u9762\u7684 *help* \u662f\u5e2e\u52a9\u4fe1\u606f\uff0c\u9ed8\u8ba4\u7684\u53c2\u6570\u683c\u5f0f\u662f\u5b57\u7b26\u4e32\uff0c\u4e5f\u5c31\u662f `str` \u5982\u679c\u4f60\u9700\u8981\u53c2\u6570\u662f\u5176\u4ed6\u5185\u5bb9\uff0c\u9700\u8981\u6307\u5b9a `type`\u3002\u4f8b\u5982\uff0c\u4f60\u9700\u8981\u7684\u53c2\u6570\u662f\u6570\u5b57\uff0c\u5c31\u9700\u8981\u7528 `type=int` \u6765\u6307\u5b9a\u7c7b\u578b\u3002\n\n**\u6dfb\u52a0\u4e00\u4e2a\u4e0d\u5e26`-`\u524d\u7f00\u7684\u9009\u586b\u7684\u53c2\u6570**\n\n```python\nparser.add_argument('targetDir', help='Select target directory', nargs='?')\n```\n\n\u5982\u4e0a\uff0c\u4f7f\u7528 `nargs='?'` \u5c31\u53ef\u4ee5\u4f7f\u8fd9\u4e2a\u53c2\u6570\u662f\u9009\u586b\u7684\u3002\u5b83\u8fd8\u6709\u5176\u4ed6\u7684\u503c\uff0c\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002\u6211\u8fd9\u91cc\u4f7f\u7528\u95ee\u53f7\u8868\u793a\u53ef\u4ee5\u63a5\u65360\u4e2a\uff08\u4e5f\u5c31\u662f\u4e0d\u586b\uff09\u6216\u80051\u4e2a\uff08\u4e5f\u5c31\u662f\u53ef\u4ee5\u586b\uff09\u503c\u3002\n\n**\u6dfb\u52a0\u4e00\u4e2a\u5e26 `-` \u524d\u7f00\u7684\u9009\u586b\u53c2\u6570**\n\n```python\nparser.add_argument(\"-a\", \"--add\", help=\"add something\")\n```\n\n\u4ee3\u7801\u5982\u4e0a\uff0c\u53ea\u9700\u8981\u52a0\u4e0a `-` \u524d\u7f00\uff0c\u90a3\u4e48\u5c31\u8868\u793a\u8fd9\u4e2a\u53c2\u6570\u662f\u9009\u586b\u4e86\u7684\u3002\u5e76\u4e14\u53ef\u4ee5\u540c\u65f6\u6307\u5b9a\u7b80\u5199\u6216\u8005\u53cc\u6a2a\u7ebf\u7684\u5168\u62fc\uff0c\u4e5f\u53ef\u4ee5\u53ea\u6307\u5b9a\u4e00\u4e2a\u3002\u6839\u636e\u4f60\u81ea\u5df1\u7684\u9700\u8981\u6765\u8fdb\u884c\u8bbe\u7f6e\u3002\n\n**\u6dfb\u52a0\u4e00\u4e2a\u4e92\u76f8\u6392\u65a5\u7684\u4e8c\u9009\u4e00\u7684\u9009\u586b\u53c2\u6570**\n\n\u4e0a\u9762\u6dfb\u52a0\u7684\u8fd9\u4e9b\u53c2\u6570\u662f\u53ef\u4ee5\u6ee1\u8db3\u5f88\u591a\u573a\u666f\uff0c\u4f46\u662f\u4e00\u4e2a\u573a\u666f\u6ee1\u8db3\u4e0d\u4e86\uff0c\u6bd4\u5982\uff0c\u6211\u9700\u8981 ` -m | -c ` \u8fd9\u4e24\u4e2a\u53c2\u6570\u53ea\u80fd\u51fa\u73b0\u4e00\u4e2a\uff0c\u5982\u679c\u540c\u65f6\u51fa\u73b0\u4e24\u4e2a\u5c31\u4e0d\u884c\u3002\u90a3\u4e48\u4e0a\u9762\u7684\u65b9\u6cd5\u5c31\u4e0d\u591f\u7528\u4e86\u3002\n\n\u6211\u4eec\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u6765\u8fdb\u884c\u5b9e\u73b0\u3002\n\n```python\ngroup = parser.add_mutually_exclusive_group()\ngroup.add_argument(\"-m\", \"--move\", help=\"The way to operate the file is to move\", action=\"store_true\")\ngroup.add_argument(\"-c\", \"--copy\", help=\"The way to operate the file is to copy\", action=\"store_true\")\n```\n\n\u5982\u4e0a\uff0c\u5b9a\u4e49\u4e00\u4e2a\u53c2\u6570\u7ec4 `group` \u7136\u540e\u5f80\u8fd9\u4e2a\u7ec4\u91cc\u6dfb\u52a0\u4e0d\u540c\u529f\u80fd\u7684\u53c2\u6570\u5373\u53ef\u3002\n\n`action=\"store_true\"` \u8fd9\u4e2a\u914d\u7f6e\u9879\u4ee3\u8868\u8fd9\u4e2a\u4e0d\u9700\u8981\u586b\u5199\u503c\uff0c\u76f4\u63a5\u5199\u53c2\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\u8f93\u51fa\u7684\u65f6\u5019\u4e3a\u5e03\u5c14\u503c\u3002\n\n**\u83b7\u53d6\u6240\u6709\u7684\u53c2\u6570**\n\n```python\nargs = parser.parse_args()\nprint(args)\n```\n\n\u597d\uff0c\u5982\u4e0a\u4ee3\u7801\uff0c\u6211\u4eec\u5c31\u628a\u53c2\u6570\u5b9a\u4e49\u4e3a\u53d8\u91cf `args` \u4e86\uff0c\u7136\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u5bf9\u8c61\u6765\u83b7\u53d6\u6211\u4eec\u7684\u5404\u79cd\u53c2\u6570\u4e86\u3002\n\n**\u6253\u5370\u5e2e\u52a9\u4fe1\u606f**\n\n\u6211\u4eec\u5728\u7a0b\u5e8f\u540e\u9762\u52a0\u4e0a `-h` \u8fd9\u4e2a\u53c2\u6570\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6211\u4eec\u7684\u7a0b\u5e8f\u7684\u8be6\u7ec6\u7684\u5e2e\u52a9\u4fe1\u606f\u3002\u8fd9\u4e2a\u662f `argparse` \u81ea\u5e26\u7684\u725b\u903c\u529f\u80fd\u3002\u7701\u5f97\u6211\u4eec\u81ea\u5df1\u53bb\u6784\u5efa\u5e2e\u52a9\u4fe1\u606f\uff0c\u6211\u8868\u793a\u975e\u5e38\u559c\u6b22\u3002\n\n\u4f46\u662f\u5982\u679c\u53ea\u6709\u8fd9\u6837\u624d\u80fd\u83b7\u53d6\u5e2e\u52a9\u4fe1\u606f\uff0c\u90a3\u4e48\u6709\u70b9\u7d22\u7136\u65e0\u5473\u4e86\u3002\u5176\u5b9e\uff0c `argparse` \u5185\u7f6e\u4e86\u4e00\u4e9b\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8ba9\u6211\u4eec\u8c03\u7528\u5e2e\u52a9\u4fe1\u606f\n\n```python\n# \u6253\u5370 usage\nparser.print_usage()\n# \u6253\u5370\u5b8c\u6574\u7684 help \u4fe1\u606f\nparser.print_help()\n# \u8f93\u51fa usage\nparser.format_usage()\n# \u8f93\u51fa help\nparser.format_help()\n```\n\n\u6253\u5370\u548c\u8f93\u51fa\u7684\u533a\u522b\u662f\uff0c\u6253\u5370\u5c31\u76f4\u63a5\u6253\u51fa\u6765\u4e86\u3002\u8f93\u51fa\u7684\u8bdd\uff0c\u53ea\u662f\u8f93\u51fa\uff0c\u4f60\u53ef\u4ee5\u62ff\u6765\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f8b\u5982\uff0c\u4f60\u60f3\u8f93\u51fa\u4e86\u4e4b\u540e\u518d\u6253\u5370\u51fa\u6765\u5c31\u53ef\u4ee5\u5982\u4e0b\u6267\u884c\uff1a\n\n```python\nprint(parser.format_help())\n```\n\n\u597d\u5427\uff0c\u6709\u70b9\u8131\u88e4\u5b50\u653e\u5c41\u7684\u610f\u601d\u3002\u4e0d\u8fc7\u4f60\u660e\u767d\u6211\u60f3\u8868\u8fbe\u4ec0\u4e48\u4e86\u3002\n\n## \u4f18\u5316\u8fc7\u7684\u201c\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u201d\u6e90\u4ee3\u7801\n\n```python\n#!\/usr\/bin\/env python3\n# -*- coding: UTF-8 -*-\nimport os\n# \u83b7\u53d6\u6587\u4ef6\u7c7b\u578b\u5e93\nimport imghdr\n# MD5\u5e93\nimport hashlib\n# \u6587\u4ef6\u64cd\u4f5c\u5e93\nimport shutil\n# \u547d\u4ee4\u884c\u5206\u6790\u5e93\nimport argparse\n\n# \u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528 argparse \u5e93\nparser = argparse.ArgumentParser()\n# \u5b9a\u4e49\u811a\u672c\u63cf\u8ff0\u4fe1\u606f\nparser.description='Move or copy the images in the source directory with the name of MD5 into the target directory'\n# \u5b9a\u4e49\u811a\u672c\u7248\u672c\nparser.add_argument(\"-v\", \"--version\",action='version', version='%(prog)s 1.0')\n\n# \u6dfb\u52a0\u6e90\u76ee\u5f55\u53c2\u6570\uff0c\u5fc5\u586b\nparser.add_argument('sourceDir', help='Select source directory')\n# \u6dfb\u52a0\u76ee\u6807\u76ee\u5f55\u53c2\u6570\uff0c\u9009\u586b\nparser.add_argument('targetDir', help='Select target directory', nargs='?')\n\n# \u5b9a\u4e49\u4e00\u4e2a\u4e92\u76f8\u6392\u65a5\u7684\u53c2\u6570\uff0ccopy or move \u4e0d\u53ef\u540c\u65f6\u5b58\u5728\ngroup = parser.add_mutually_exclusive_group()\ngroup.add_argument(\"-m\", \"--move\", help=\"The way to operate the file is to move\", action=\"store_true\")\ngroup.add_argument(\"-c\", \"--copy\", help=\"The way to operate the file is to copy\", action=\"store_true\")\n\n# \u5c06\u53c2\u6570\u547d\u540d\u4e3a\u53d8\u91cf args\nargs = parser.parse_args()\n\n# \u8bbe\u5b9a\u9ed8\u8ba4\u53c2\u6570\nsourceDir = args.sourceDir\ntargetDir = args.targetDir or args.sourceDir\noperation = 'copy' if args.copy == True else 'move'\nimages = []\n\n# \u5b9a\u4e49\u51fa\u9519\u51fd\u6570\ndef errUsage(res):\n    print('error: ' + res)\n    parser.print_usage()\n    exit()\n\n# \u627e\u5230\u6e90\u76ee\u5f55\u4e0b\u6240\u6709\u7684\u56fe\u7247\ndef findImage(sourceDir):\n    # \u5982\u679c\u6e90\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u5219\u62a5\u9519\u9000\u51fa\n    if not os.path.exists(sourceDir):\n        errUsage('Source directory is not defined')\n    # \u5faa\u73af\u76ee\u6807\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\n    for fil in os.listdir(sourceDir):\n        # \u53d6\u5f97\u6587\u4ef6\u7684\u8def\u5f84\n        filPath = os.path.join(sourceDir, fil)\n        # \u5224\u65ad\u6587\u4ef6\u662f\u5426\u4e3a\u76ee\u5f55\n        if not os.path.isdir(filPath):\n            # \u5224\u65ad\u6587\u4ef6\u662f\u5426\u4e3a\u56fe\u7247\n            if imghdr.what(filPath) != None:\n                # \u5c06\u56fe\u7247\u63d2\u5165\u9700\u8981\u5904\u7406\u7684\u5217\u8868\n                images.append(filPath)\n# \u8ba1\u7b97 MD5 \u503c\u51fd\u6570\ndef calcMD5(filepath):\n    with open(filepath,'rb') as f:\n        md5obj = hashlib.md5()\n        md5obj.update(f.read())\n        hash = md5obj.hexdigest()\n        return hash\n\n# \u5904\u7406\u6240\u6709\u56fe\u7247\ndef md5img(images):\n    # \u5982\u679c\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u5219\u62a5\u9519\u9000\u51fa\n    if not os.path.exists(targetDir):\n        errUsage('Target directory is not defined')\n\n    method = {\n        \"move\": shutil.move,\n        \"copy\": shutil.copy\n    }\n    # \u5faa\u73af\u9700\u8981\u5904\u7406\u7684\u56fe\u7247\u5217\u8868\n    for img in images:\n        # \u6839\u636e\u56fe\u7247\u7684\u771f\u5b9e\u540e\u7f00\uff0c\u6765\u786e\u5b9a\u56fe\u7247\u7684\u540e\u7f00\uff0c\u5982\u679c\u662f jpeg \u5219\u6539\u6210 jpg\n        postfix = 'jpg' if imghdr.what(img) == 'jpeg' else imghdr.what(img)\n        # \u6267\u884c\u590d\u5236\u6216\u8005\u79fb\u52a8\u64cd\u4f5c\n        method[operation](img, targetDir + '\/' + calcMD5(img) + '.' + postfix)\n# \u627e\u56fe\u7247\nfindImage(sourceDir)\n# \u5904\u7406\u56fe\u7247\nmd5img(images)\n# \u5b8c\u6210\nprint('Finish')\n```\n\n\u4ee3\u7801\u4e2d\u5df2\u7ecf\u6dfb\u52a0\u4e86\u5f88\u591a\u7684\u6ce8\u91ca\u4e86\uff0c\u5e94\u8be5\u6765\u8bf4\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u770b\u61c2\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u7a0b\u5e8f\u6267\u884c\u6548\u679c\u5982\u4e0b\u56fe\u6240\u793a\uff1a\n\n![\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u56fe\u7247\u7528MD5\u91cd\u547d\u540d\u540e\u79fb\u52a8\u6216\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939](http:\/\/img.blog.csdn.net\/20171212172932800?watermark\/2\/text\/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvRnVuZ0xlbw==\/font\/5a6L5L2T\/fontsize\/400\/fill\/I0JBQkFCMA==\/dissolve\/70\/gravity\/SouthEast)\n\nOK\uff0c\u7ec8\u4e8e\u628a\u8fd9\u4e2a\u811a\u672c\u7ed9\u5199\u5f97\u76f8\u5bf9\u6765\u8bf4\u6ee1\u610f\u4e86\u3002\n\n\u672c\u6587\u7531 FungLeo \u539f\u521b\uff0c\u5141\u8bb8\u8f6c\u8f7d\uff0c\u4f46\u8f6c\u8f7d\u5fc5\u987b\u4fdd\u7559\u9996\u53d1\u94fe\u63a5\u3002\n\n","private":0,"tags":"python,argparse","categories":"python3","channel":"16","type":"original","status":1},"error":"","status":true}